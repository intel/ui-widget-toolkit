!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3"),require("pixi.js"),require("es6-promise"),require("d3-sankey"),require("dagre")):"function"==typeof define&&define.amd?define("UWT",["d3","pixi.js","es6-promise","d3-sankey","dagre"],e):"object"==typeof exports?exports.UWT=e(require("d3"),require("pixi.js"),require("es6-promise"),require("d3-sankey"),require("dagre")):t.UWT=e(t.d3,t.PIXI,t["es6-promise"],t.Sankey,t.dagre)}(window,(function(t,e,n,r,i){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=35)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Top=4]="Top",t[t.Bottom=8]="Bottom",t[t.None=0]="None"}(e.Alignment||(e.Alignment={})),function(t){t[t.CursorStart=0]="CursorStart",t[t.CursorMove=1]="CursorMove",t[t.CursorEnd=2]="CursorEnd",t[t.BrushStart=3]="BrushStart",t[t.BrushMove=4]="BrushMove",t[t.BrushEnd=5]="BrushEnd",t[t.HoverStart=6]="HoverStart",t[t.HoverEnd=7]="HoverEnd",t[t.HoverClear=8]="HoverClear",t[t.Zoom=9]="Zoom",t[t.Click=10]="Click",t[t.DoubleClick=11]="DoubleClick",t[t.RangeUpdate=12]="RangeUpdate"}(e.EventType||(e.EventType={})),function(t){t[t.Unrendered=0]="Unrendered",t[t.Cartesian=1]="Cartesian",t[t.Pie=2]="Pie",t[t.Grid=3]="Grid",t[t.FlowDiagram=4]="FlowDiagram",t[t.ForceDirectedGraph=5]="ForceDirectedGraph",t[t.Sunburst=6]="Sunburst",t[t.HierarchyGraph=7]="HierarchyGraph",t[t.PortDiagram=8]="PortDiagram",t[t.SimpleGraph=9]="SimpleGraph",t[t.TreeMap=10]="TreeMap",t[t.Axis=11]="Axis",t[t.Radar=12]="Radar"}(e.UIType||(e.UIType={})),function(t){t[t.Discrete=0]="Discrete",t[t.Gradient=1]="Gradient"}(e.LegendType||(e.LegendType={})),function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(e.LegendOrientation||(e.LegendOrientation={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.Line=1]="Line",t[t.Circle=2]="Circle"}(e.LegendItemShape||(e.LegendItemShape={}));e.Rect=class{constructor(t,e,n,r){this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=r}contains(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height}};e.Css=class{constructor(t,e){t?this.addClasses(t):this.classes={},this.style=e||{}}addClasses(t){let e=t.split(" ");for(let t=0;t<e.length;++t)this.classes[e[t]]=!0;return this}addStyles(t){for(let e in t)this.style[e]=t[e];return this}setColor(t){return this.addStyles({color:t}),this}setOpacity(t){return this.addStyles({opacity:t}),this}removeClass(t){return delete this.classes[t],this}removeStyle(t){return delete this.style[t],this}getClasses(){return Object.keys(this.classes)}getClassString(){let t="";for(let e in this.classes)t+=e+" ";return t}getStyles(){return this.style}getStyleString(){return JSON.stringify(this.style)}};e.Range=class{constructor(t,e){this.min=t,this.max=e}setMin(t){return this.min=t,this}getMin(){return this.min}setMax(t){return this.max=t,this}getMax(){return this.max}}},function(t,e,n){"use strict";function r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function i(t){return function(e,n){return r(t(e),n)}}function o(t){return t||(t=r),1===t.length&&(t=i(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionName=function(t){return"number"==typeof t?"n"+t:t?(t.length>0&&!isNaN(Number(t[0]))&&(t="z"+t),t=t.replace(/[\*\%\#\[\]\/\>\<\s\+\(\)\;\@\:\?\"=.,]/g,"-")):""},e.removeFromList=function(t,e){if(t){let n=e.indexOf(t);-1!==n&&e.splice(n,1)}},e.bisect=o,e.bucketData=function(t,e,n){let r=o().right,i=[];for(let t=0;t<e.length-1;++t)i[t]=[];let a=e[0],s=e[e.length-1],l=e.slice(1);for(let e=0;e<t.length;++e){let o=n(t[e]);o<a||o>s||i[r(l,o)].push(t[e])}let h={};for(let t=0;t<e.length-1;++t){h[e[t]+"-"+e[t+1]]=i[t]}return h},e.copy=function(t){let e={};for(let n in t)e[n]=t[n];return e},e.merge=function(t,e){for(let n in e)t[n]=e[n]},e.convertTraceToTrees=function(t){let e=[],n=[],r=[];for(let i=0;i<t.length;i++){let o=t[i],a=n[n.length-1];for(;n.length&&o.x>a.x+a.dx;)--n.length,--r.length,a=n[n.length-1];let s=r[r.length-1],l={key:o.key,value:o.dx,children:[],parent:s};o.name&&(l.name=o.name),s?s.children.push(l):e.push(l),n.push(o),r.push(l)}return e};e.SimpleBuffer=class{constructor(t){this._data=t||[]}push(t){this._data.push(t)}get(t){return this._data[t]}length(){return this._data.length}getData(){return this._data}};e.RingBuffer=class{constructor(t){this._data=new Array(t),this._startIdx=0,this._count=0,this._isRotating=!1}push(t){this._isRotating?(this._data[this._startIdx]=t,++this._startIdx,this._startIdx===this._count&&(this._startIdx=0),this._isRotating=!0):this._count===this._data.length-1?(this._data[this._count]=t,++this._count,this._isRotating=!0):(this._data[this._count]=t,++this._count)}get(t){return this._isRotating&&(t+=this._startIdx)>=this._count&&(t-=this._count),this._data[t]}length(){return this._count}getData(){if(this._isRotating){let t=[];for(let e=this._startIdx;e<this._data.length;++e)t.push(this._data[e]);for(let e=0;e<this._startIdx;++e)t.push(this._data[e]);return t}return this._data}},e.bisectBuffer=function(t){return t||(t=r),1===t.length&&(t=i(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length());r<i;){var o=r+i>>>1;t(e.get(o),n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length());r<i;){var o=r+i>>>1;t(e.get(o),n)>0?i=o:r=o+1}return r}}},e.transposeKeys=function(t){let e={};function n(t,r,i,o){let a=[];for(let t=0;t<r.length;++t)a[t]=r[t];if(a.push(i.key),Array.isArray(i.data))for(let e=0;e<i.data.length;++e)n(t,a,i.data[e],o+1);else{let n=t;for(let t=a.length-1;t>=0;--t){let r,o=a[t];e.hasOwnProperty(o)?r=e[o]:(r=n.length,e[o]=r),n[r]||(n[r]={key:o,data:[]}),0===t?n[r].data=i.data:n=n[r].data}}}let r=[];for(let e=0;e<t.length;++e)n(r,[],t[e],0);return r},e.runFunctionOnLeaf=function t(e,n){if(e&&e.children&&e.children.length>0)for(let r=0;r<e.children.length;++r)t(e.children[r],n);else n(e)},e.isOverlapping=function(t,e){return t.x<=e.right&&t.right>=e.x&&t.y<=e.bottom&&t.bottom>=e.y}},function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(0),o=n(7),a=n(19),s=n(29),l=n(4),h=n(2);function u(t,e,n){let r,i=t.attr("style"),o=t.style("fill");o&&"none"!==o&&(r=a.SelectionHelper.getHoverColor(o),t.style("fill",r)),i&&e.set(t.node(),o),o=t.style("stroke"),o&&"none"!==o&&(r=a.SelectionHelper.getHoverColor(o),t.style("stroke",r)),i&&n.set(t.node(),o),t.classed("hover",!0)}function c(t,e,n){t.style("fill",e.get(t.node())),t.style("stroke",n.get(t.node())),t.classed("hover",!1)}function d(t,e,n){if(t.getScreenCTM&&t.getScreenCTM()){let e=t.getScreenCTM().inverse();return n.matrixTransform(e)}return{x:n.x,y:n.y}}function g(t,e){let n=e.node().getBoundingClientRect(),r=t.node(),i=(e.node(),r.createSVGPoint());i.x=n.left,i.y=n.top;let o=d(r,0,i);i.x=n.right,i.y=n.bottom;let a=d(r,0,i);return{x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,right:a.x,bottom:a.y}}e.getStyle=function(t){let e=t.node();return window.getComputedStyle(e)},e.mergeKeys=function(t,e){let n={};for(let e=0;e<t.length;++e)n[t[e]]=!0;for(let r=0;r<e.length;++r)n.hasOwnProperty(e[r])||t.push(e[r])},e.getKeys=function(t,e){let n={},r=[];for(let i=0;i<t.length;++i){let o=e(t[i]);for(let t=0;t<o.length;++t)"string"!=typeof o[t]&&"number"!=typeof o[t]||n.hasOwnProperty(o[t])||(n[o[t]]=!0,r.push(o[t]))}return r},e.addHover=u,e.removeHover=c,e.addClickHelper=function(t,e,n,r,a,s,l){let u;e&&t.on("click",(function(t){void 0!==l&&(t=l),n?u=setTimeout((function(){u&&(e({caller:s,event:i.EventType.Click,data:t}),u=null)}),300):e({caller:s,event:i.EventType.Click,data:t})})),n&&t.on("dblclick",(function(t){void 0!==l&&(t=l),window.clearTimeout(u),u=null,n({caller:s,event:i.EventType.DoubleClick,data:t})})),r&&r.length&&t.on("contextmenu",(function(t){event||(event=h.event),o.showContextMenu(h.event,t,r)}))},e.convertToSVGCoords=g,e.getTextRect=function(t,e){let n=t.append("text").text(e),r=g(t,n);return n.remove(),r},e.animatePath=function(t,e){let n=t.node().getTotalLength();t.attr("stroke-dasharray",n).attr("stroke-dashoffset",n).transition("add").duration(e).attr("stroke-dashoffset",0)};class p{static getAngle(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI}static translateArrow(t){return function(e,n,r){return function(e){var n=t.getTotalLength(),r=t.getPointAtLength(e*n),i=t.getPointAtLength(Math.max(n-.01,0)*e),o=t.getPointAtLength((n+.01)*e);return"translate("+r.x+", "+r.y+") rotate( "+p.getAngle(i,o)+")"}}}static createArrow(t,e=4){let n=2*e;return t.append("path").attr("d",`M -${n}, -${e} L0,0 L-${n},${e} z`)}static animateArrow(t,e,n){e.transition().duration(n).attrTween("transform",p.translateArrow(t.node()))}}e.Arrow=p;e.Spinner=class{constructor(t,e){let n=this,r=Math.min(e.width,e.height)/2,i=2*Math.PI;n._svg=t;let o=h.arc().innerRadius(.5*r).outerRadius(.9*r).startAngle(0);n._svg.append("path").classed("spinner",!0).datum({endAngle:.66*i}).style("fill","rgb(0,113,197)").attr("d",o).call((function t(e,r){e.transition().ease(h.easeLinear).duration(r).attrTween("transform",(function(){return h.interpolateString("rotate(0)","rotate(360)")})),setTimeout((function(){n._svg&&t(e,r)}),r)}),1500)}};e.Brush=class{constructor(){let t=this;t._isXY=!1,this.onBrushStart=function(e){if(t._onStartCallback){let e=h.brushSelection(this);t._onStartCallback.call(this,e)}},this.onBrushMove=function(e){if(t._onMoveCallback){let e=h.brushSelection(this);t._onMoveCallback.call(this,e)}},this.onBrushEnd=function(e){if(t._onEndCallback){let e=h.brushSelection(this);t._onEndCallback.call(this,e)}}}moveToFront(){this._brushTargetGraph.each((function(){this.parentNode.appendChild(this)}))}moveToBack(){this._brushTargetGraph.each((function(){let t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)}))}enableCallbacks(){return this._brush.on("start",this.onBrushStart).on("brush",this.onBrushMove).on("end",this.onBrushEnd),this}disableCallbacks(){return this._brush.on("start",void 0).on("brush",void 0).on("end",void 0),this}brushStart(t){this._brushTargetGraph.call(this._brush.move,null)}brushMove(t){this._brushTargetGraph.call(this._brush.move,t)}brushEnd(){this._brushTargetGraph.call(this._brush.move,null)}setXY(t){return this._isXY=t,this}setTarget(t){return this._brushTargetGraph=t,this}setStartCallback(t){return this._onStartCallback=t,this}setMoveCallback(t){return this._onMoveCallback=t,this}setEndCallback(t){return this._onEndCallback=t,this}setRect(t){return this._rect=t,this}ready(){return this._isXY?this._brush=h.brush().on("start",this.onBrushStart).on("brush",this.onBrushMove).on("end",this.onBrushEnd):this._brush=h.brushX().extent([[0,0],[this._rect.width,this._rect.height]]).on("start",this.onBrushStart).on("brush",this.onBrushMove).on("end",this.onBrushEnd),this._brushTargetGraph.call(this._brush),this}static releaseListeners(t){t.on("brush",null).on("brushend",null).on("brushstart",null)}};e.D3Legend=class{constructor(t,e,n,r){if(this._title=n||"",this._legend=e,this._itemMap={},this._items=[],e.definition){let t=[];for(let n=0;n<e.definition.items.length;++n){let r=e.definition.items[n];t.push({key:r.key,name:r.name?r.name:r.key,color:r.color,shape:this.getShapeString(r.shape),opacity:""})}this.addItems(t)}let o="ordinal";this._legend.definition&&this._legend.definition.type===i.LegendType.Gradient&&(o="gradient"),this._classes=`legend ${o} ${this._title} align-${this._legend.alignment}`,this._legendSvg=t.append("g").classed(this._classes,!0),this.setPosition(r)}getShapeString(t){if("string"==typeof t)return t;switch(t){case i.LegendItemShape.Rectangle:return"rect";case i.LegendItemShape.Line:return"line";case i.LegendItemShape.Circle:return"circle"}}setPosition(t){this._position=t}getPosition(){return this._position}setItems(t){this._items=[],this._itemMap={},this.addItems(t)}addItems(t){for(let e=0;e<t.length;++e){let n=t[e];this._itemMap.hasOwnProperty(n.key)?(this._itemMap[n.key].color=n.color,this._itemMap[n.key].opacity=n.opacity):(n.name||(n.name=n.key,this._legend.showValue&&void 0!==n.value&&(n.name+=": "+n.value,void 0!==n.units&&(n.name+=n.units))),this._itemMap[n.key]=n,this._items.push(n))}}getAlignment(){return this._legend.alignment}getRenderedRect(){return this._renderedRect}getRows(){return this._legend.orientation===i.LegendOrientation.Vertical?this._items.length:this._legendSvg.selectAll(".legendCells").size()}renderDiscreteLegend(t){let e=[],n=[];for(let t=0;t<this._items.length;++t){this._items[t].name;let r=this._items[t].color,i=this._items[t].opacity;i&&r.startsWith("rgb")&&(r="rgba"+r.substr(3,r.length-4)+" , "+i+")"),e.push(this._items[t].name),n.push(r)}let r=2,a=0,l=this,u=function(e,n,a){let u=h.scaleOrdinal().domain(n).range(a),c=s.legendColor();c.on("cellover",(function(t){this.setAttribute("title",t)})).orient(t).labelPosition("right").shape("rect").shapeWidth(10).shapeHeight(10).shapePadding(r).scale(u),l._legend.onClick&&c.on("cellclick",(function(t){l._legend.onClick({event:i.EventType.Click,data:t})})),l._legend.contextMenuItems&&c.on("cellcontextmenu",(function(t){o.showContextMenu(h.event,t,l._legend.contextMenuItems)})),e.call(c)};u(this._legendSvg,e,n);let c=this._position.x;if((this._legend.alignment===i.Alignment.Top||this._legend.alignment===i.Alignment.Bottom)&&this._legend.orientation!==i.LegendOrientation.Vertical){r=0;this._legendSvg.select(".legendCells").selectAll(".cell").each((function(){let t=this.getBBox();r=Math.max(r,t.width)}));a=r+10,this._legendSvg.selectAll("*").remove();let t=Math.max(1,Math.min(e.length,Math.floor(this._position.width/a)));Math.ceil(e.length/t),c=this._position.x+this._position.width/2-a*t/2;let i=0;for(let r=0;r<e.length;r+=t){let o=this._legendSvg.append("g").classed(this._classes,!0);u(o,e.slice(r,r+t),n.slice(r,r+t)),i&&o.attr("transform","translate(0,"+i+")"),i+=o.node().getBoundingClientRect().height}}c=Math.max(0,c),this._legendSvg.attr("transform","translate("+c+","+this._position.y+")")}renderGradientLegend(){this._legendSvg.selectAll("*").remove();let t=this._legend.definition.items,e=r.getSelectionName(`${this._title}align-${this._legend.alignment}`),n=this._legendSvg.append("linearGradient").attr("id",e).attr("x1","0%").attr("y1","0%");t.forEach(t=>{n.append("stop").attr("offset",`${t.key}%`).attr("style",`stop-color:${t.color};stop-opacity:${t.opacity}`)});let o,a=h.scaleLinear().domain(h.extent(t,t=>Number(t.key))),s=this._legendSvg.append("rect"),l=this._legendSvg.append("g");switch(this._legend.alignment){case i.Alignment.Left:n.attr("x2","0%").attr("y2","100%"),s.attr("x",30).attr("width",40).attr("y",0).attr("height",this._position.height),a.range([0,this._position.height]),l.attr("transform","translate(30, 0)"),o=h.axisLeft(a);break;case i.Alignment.Right:n.attr("x2","0%").attr("y2","100%"),s.attr("x",5).attr("width",40).attr("y",0).attr("height",this._position.height),a.range([0,this._position.height]),l.attr("transform","translate(45, 0)"),o=h.axisRight(a);break;case i.Alignment.Top:n.attr("x2","100%").attr("y2","0%"),s.attr("x",0).attr("width",this._position.width).attr("y",10).attr("height",40),a.range([0,this._position.width]),l.attr("transform","translate(0, 10)"),o=h.axisTop(a);break;case i.Alignment.Bottom:n.attr("x2","100%").attr("y2","0%"),s.attr("x",0).attr("width",this._position.width).attr("y",5).attr("height",40),a.range([0,this._position.width]),l.attr("transform","translate(0, 45)"),o=h.axisBottom(a)}s.attr("fill",`url(#${e})`),l.call(o),this._legendSvg.attr("transform","translate("+this._position.x+","+this._position.y+")")}render(){let t;if(t=this._legend.orientation===i.LegendOrientation.Vertical?"vertical":this._legend.orientation===i.LegendOrientation.Horizontal?"horizontal":this._legend.alignment===i.Alignment.Left||this._legend.alignment===i.Alignment.Right?"vertical":"horizontal",this._legendSvg.selectAll("*").remove(),this._legend.definition&&this._legend.definition.type&&this._legend.definition.type===i.LegendType.Gradient){this.renderGradientLegend();let t=this._legendSvg.node().getBoundingClientRect();this._renderedRect=new i.Rect(t.left,t.top,t.right-t.left+40,t.bottom-t.top)}else{this.renderDiscreteLegend(t);let e=this._legendSvg.node().getBoundingClientRect();this._renderedRect=new i.Rect(e.left,e.top,e.right-e.left,e.bottom-e.top)}}};class f extends l.UIElementRenderer{constructor(){super(),this.MIN_MARGIN={TOP:0,BOTTOM:10,LEFT:0,RIGHT:10},this.LEGEND_PADDING={X:10,Y:{TOP:10,BOTTOM:10}},this.AXIS_PADDING={X:10,Y:{TOP:10,BOTTOM:10}},this._fillColors=new WeakMap,this._strokeColors=new WeakMap;let t=this;this._options={},this._minSvgWidth=0,this._maxGraphWidth=Number.MAX_VALUE,this._maxSvgWidth=Number.MAX_VALUE,this._selectionHelper=new a.SelectionHelper((function(e){t.addHover(e)}),(function(e){t.removeHover(e)}))}cursorChange(t){}zoom(t){}brush(t){}render(t){}configureTooltip(){}createLayout(){}setColorManager(t){this._colorMgr=t}initialize(t,e,n){this._element=t,this._renderer=e,this._tooltipId="d3-tooltip",this._tooltipAnalyticsName="d3-ui-widget-toolkit",this._parent=n;let r=n.node();r&&(this._options.width||(this._options.width=r.getBoundingClientRect().width),this._svgRect=new i.Rect(0,0,this._options.width,0),this._svg=n.append("svg")),this._handleWidth=10,this._graphRect=new i.Rect(0,0,0,this.DEFAULT_GRAPH_HEIGHT),this._requiresRelayout=!0}loadOptions(t){void 0!==t&&(t.width&&t.width!==this._options.width&&(this._requiresRelayout=!0),t.height&&t.height!==this._options.height&&(this._requiresRelayout=!0),t.topMargin&&t.topMargin!==this._options.topMargin&&(this._requiresRelayout=!0),t.bottomMargin&&t.bottomMargin!==this._options.bottomMargin&&(this._requiresRelayout=!0),t.leftMargin&&t.leftMargin!==this._options.leftMargin&&(this._requiresRelayout=!0),t.rightMargin&&t.rightMargin!==this._options.rightMargin&&(this._requiresRelayout=!0),r.merge(this._options,t))}getElement(){return this._element}getOptions(){return this._options}getAnimateDuration(){return void 0!==this._options.animateDuration?this._options.animateDuration:1e3}getRenderedCss(){return new i.Css}getTooltipData(t){return[{source:this._element,group:"",metrics:{}}]}hover(t){this._selectionHelper.onSelect(t)}addHover(t){let e=this;t&&e._svg.selectAll("."+t).each((function(){u(h.select(this),e._fillColors,e._strokeColors)}))}removeHover(t){let e=this;t.length>0&&e._svg.selectAll("."+t).each((function(){c(h.select(this),e._fillColors,e._strokeColors)}))}invalidate(t){this.loadOptions(t),this.createLayout(),t.disableResize||this.createHandles(),this.configureTooltip(),this.render(t),this._selectionHelper.onRedraw()}updateHandles(){this._svg.select(".chart-handle.bottom").attr("x",this._graphRect.x).attr("y",this._graphRect.y+this._graphRect.height).attr("width",this._graphRect.width),this._svg.select(".chart-handle.left").attr("x",this._graphRect.x-this._handleWidth-1).attr("y",this._graphRect.y).attr("height",this._graphRect.height),this._svg.select(".chart-handle.right").attr("x",this._graphRect.x+this._graphRect.width+1).attr("y",this._graphRect.y).attr("height",this._graphRect.height)}createHandles(){let t=this;t._options.disableResizeLeft||t._svg.append("rect").attr("opacity",0).attr("width",t._handleWidth).attr("cursor","ew-resize").classed("chart-handle vertical left",!0).call(h.drag().on("start",(function(){f.IS_RESIZING=!0})).on("drag",(function(){if(0===h.event.dx)return;let e=Math.min(t._options.leftMargin+t._graphRect.width,Math.max(t.MIN_MARGIN.LEFT,t._options.leftMargin+h.event.dx)),n={width:t._svg.node().getBoundingClientRect().width,leftMargin:e,xStart:t._options.xStart,xEnd:t._options.xEnd,animateDuration:0};t._element.handleUpdate?t._element.handleUpdate(t._element,n):t.render(n)})).on("end",(function(){f.IS_RESIZING=!1}))),t._options.disableResizeRight||t._svg.append("rect").attr("opacity",0).attr("width",t._handleWidth).attr("cursor","ew-resize").classed("chart-handle vertical right",!0).call(h.drag().on("start",(function(){f.IS_RESIZING=!0})).on("drag",(function(){if(0===h.event.dx)return;t._svg.node();let e=t._options.width+h.event.dx;e=Math.max(t._minSvgWidth,e),e=Math.min(t._maxSvgWidth,e);let n={width:e,xStart:t._options.xStart,xEnd:t._options.xEnd,animateDuration:0};t._element.handleUpdate?t._element.handleUpdate(t._element,n):t.render(n)})).on("end",(function(){f.IS_RESIZING=!1})))}createImage(){let t=this;return new Promise((function(e,n){let r=t._svg,i=Number(r.attr("width")),o=Number(r.attr("height")),a=function(t){t.setAttribute("xlink","http://www.w3.org/1999/xlink"),function(t,e){let n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;let r=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,r)}(function(t){let e=[];e.push("#"+t.id);for(let n=0;n<t.classList.length;n++)i("."+t.classList[n],e)||e.push("."+t.classList[n]);let n=t.getElementsByTagName("*");for(let t=0;t<n.length;t++){let r=n[t].id;i("#"+r,e)||e.push("#"+r);let o=n[t].classList;for(let t=0;t<o.length;t++)i("."+o[t],e)||e.push("."+o[t])}let r="";for(let t=0;t<document.styleSheets.length;t++){let n=document.styleSheets[t];try{if(!n.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}let o=n.cssRules;for(let t=0;t<o.length;t++)i(o[t].selectorText,e)&&(r+=o[t].cssText)}return r;function i(t,e){return-1!==e.indexOf(t)}}(t),t);let e=(new XMLSerializer).serializeToString(t);return e=e.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),e=e.replace(/NS\d+:href/g,"xlink:href"),e}(r.node()),s="data:image/svg+xml;base64,"+btoa(a),l=new Image;l.src=s,l.onload=function(){let t=document.createElement("canvas");t.height=o,t.width=i,t.getContext("2d").drawImage(l,0,0,i,o);let n=t.toDataURL("image/png");e({image:n,type:"image/png",height:o,width:i})}}))}saveImage(){this.createImage().then((function(t){let e=`<img src="${t.image}" height="${t.height}" width="${t.width}">`;h.select("#pngdataurl").html(e);let n=document.createElement("a");n.download="chart.png",n.href=t.image,n.click()}))}}e.SVGRenderer=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(8),o=n(2);let a,s={};"undefined"!=typeof document&&(a=document.createElement("canvas").getContext("2d")),e.getTextWidth=function(t,e,n){return a.font=n+"px "+e,a.measureText(t).width};e.UIElementRenderer=class{getOptions(){return this._options}getColorManager(){return this._colorMgr}setColorManager(t){this._colorMgr=t}};class l{constructor(t,e=new i.ColorManager){t&&(this._parentId=t,this._parent=o.select("body").select(t)),e&&(this._colorMgr=e),this._rendererMap=new WeakMap}static register(t,e){s[t]=e}setOnRenderCallback(t){this.onRender=t}clearDiv(t){if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}setDiv(t){this._parent=o.select(t)}getRenderedCss(t){return this._rendererMap.has(t)?this._rendererMap.get(t).getRenderedCss():new r.Css}hover(t,e){if(this._rendererMap.has(t))return this._rendererMap.get(t).hover(e)}zoom(t,e){this._rendererMap.has(t)&&this._rendererMap.get(t).zoom(e)}getTooltipData(t,e){return this._rendererMap.has(t)?this._rendererMap.get(t).getTooltipData(e):[{source:t,group:"",metrics:{}}]}cursorChange(t,e){if(this._rendererMap.has(t))return this._rendererMap.get(t).cursorChange(e)}brush(t,e){if(this._rendererMap.has(t))return this._rendererMap.get(t).brush(e)}configureElement(t){if(t.renderer=this,!this._rendererMap.has(t)){this._parent.node()||(this._parent=o.select(this._parentId));let e=s[t.type];if(e){let n=new e(t,this,this._parent);n.setColorManager(this._colorMgr),this._rendererMap.set(t,n)}}}render(t,e={}){t.renderer=this,this.configureElement(t),this._rendererMap.has(t)&&(this._rendererMap.get(t).render(e),t.onRender&&t.onRender(e),this.onRender&&this.onRender(t,e))}invalidate(t,e={}){t.renderer=this,this.configureElement(t),this._rendererMap.has(t)&&(this._rendererMap.get(t).invalidate(e),t.onRender&&t.onRender(e),this.onRender&&this.onRender(t,e))}setColorManager(t){this._colorMgr=t}getColorManager(){return this._colorMgr}destroy(t){this._rendererMap.delete(t)}getOptions(t){if(this._rendererMap.has(t))return this._rendererMap.get(t).getOptions()}}e.D3Renderer=l,e.D3ChartRenderer=l,e.D3GraphRenderer=l},,,function(t,e,n){"use strict";function r(t,e,n,a,s){let l;if(l=document.createElement("div"),l.setAttribute("class","context-menu"),l.oncontextmenu=function(t){o(),t.preventDefault()},document.body.appendChild(l),n.length>0){let h=document.createElement("ul");l.appendChild(h);for(let a=0;a<n.length;++a){let l=n[a],u=document.createElement("li");l.divider?(u.className+=" is-divider",u.innerHTML="<hr>"):(l.title||console.error("No title attribute set. Check the spelling of your options."),l.disabled&&(u.className+=" is-disabled"),l.action||l.submenu||(u.className+=" is-header"),l.submenu?u.innerHTML="<span><text>"+l.title+'</text><text style="width: 5px; float: right">&#9658</text></span>':u.innerHTML=l.title,u.onclick=function(t){l.disabled||l.action&&(l.action(u,e,a),o())},u.onmouseenter=function(){if(i(n),l.submenu){let n=u.getBoundingClientRect(),i={top:n.top+window.scrollY,bottom:n.bottom+window.scrollY,left:n.left+window.scrollX,right:n.right+window.scrollX,height:n.height,width:n.width};l.submenuDiv=r(t,e,l.submenu,i,s)}}),h.appendChild(u)}l.style.display="block",function(t,e){let n=document.body.clientWidth,r=document.body.clientHeight,i=e.left,o=e.top;i=e.right+t.clientWidth<n?e.right:e.left-t.clientWidth,e.top+t.clientHeight>r&&(o=e.top-t.clientHeight),t.style.left=i-2+"px",t.style.top=o-2+"px"}(l,a),s||t.stopPropagation()}return l}function i(t){t.forEach((function(t,e,n){!function(t){t.submenuDiv&&(document.body.removeChild(t.submenuDiv),delete t.submenuDiv),t.submenu&&i(t.submenu)}(t)}))}function o(){i(a);let t=document.getElementsByClassName("context-menu");for(;t.length;)document.body.removeChild(t[0])}Object.defineProperty(e,"__esModule",{value:!0});let a=[];e.showContextMenu=function(t,e,n,i=!1){t&&(window.onkeyup=function(t){27===t.keyCode&&o()},o(),a=n,r(t,e,n,{left:t.pageX,top:t.pageY,right:t.pageX,bottom:t.pageY,height:0,width:0},i),t.preventDefault())}},function(t,e,n){"use strict";function r(t){var e=Number(t).toString(16);return 1==e.length?"0"+e:e}function i(t){let e=t.substring(t.indexOf("(")+1,t.indexOf(")")).split(",");return r(e[0])+r(e[1])+r(e[2])}Object.defineProperty(e,"__esModule",{value:!0});class o{constructor(t){this._colorMap={},this.getRandomColor=t||function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}}hasColor(t){return this._colorMap.hasOwnProperty(t)}setColor(t,e){0===e.indexOf("rgb")&&(e=o.RgbToHex(e)),this._colorMap[t]=e}getColor(t){return this.hasColor(t)||(this._colorMap[t]=this.getRandomColor()),this._colorMap[t]}static IntToHex(t){return"#"+t.toString(16).padStart(6,"0")}static RgbToHex(t){return"#"+i(t)}static RgbToInt(t){return parseInt(i(t),16)}}e.ColorManager=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);class i{constructor(t,e="tooltip-t"){if(document.getElementById(t)){let e=t;"#"!==t.charAt(0)&&(e="#"+t),this._tooltipDiv=document.querySelector(e)}else this._tooltipDiv=document.createElement("div"),this._tooltipDiv.style.overflow="auto",this._tooltipDiv.id=t,document.querySelector("body").appendChild(this._tooltipDiv);this._targets=[],this._analyticsName="",this._disabled=!1,this._visibilityTimeoutSecs=0,this._visibilityTimeoutCallLeaveFunction=!0,this._delayMS=i._defaultDelayMS,this._tooltipPlacementFunc=this.defaultTooltipPlacement,this._alwaysRecalcWidth=!1,this._tooltipLeftOfMouse=!0,this._lastShowTs=Date.now(),this._counter=i._counter,i._counter++,this._hide="none",this._tooltipOffset=0,this._tooltipHeight=0,this._tooltipWidth=0,this._windowWidth=0,this._windowHeight=0,this._tooltipDiv.classList.add(e),this._tooltipBackgroundColor=null,this._tooltipFontColor=null,this._tooltipFontType=null,this._tooltipFontSize=null;let n=this;this.onMouseEnter=function(t){n._disabled||(void 0===n._enterfunc||n._enterfunc.call(this,t)?(n.displayTooltip(n._delayMS),n._tooltipHeight=0,n._tooltipWidth=0,n._windowWidth=0,n._windowHeight=0):n.onMouseLeave.call(this,t))},this.onMouseLeave=function(t){if(null!=n._timerId&&window.clearTimeout(n._timerId),n._timerId=void 0,null!=n._visibilityTimerId&&window.clearTimeout(n._visibilityTimerId),void 0!==n._leavefunc){let e=!0;null===t&&(e=n._visibilityTimeoutCallLeaveFunction),e&&n._leavefunc.call(this,t)}n.hideTooltip()},this.onMouseMove=function(t,e){if(!n._disabled){if(void 0!==n._movefunc&&n._movefunc.call(this,t),n._alwaysRecalcWidth||0===n._tooltipWidth){n._tooltipWidth=n._tooltipDiv.offsetWidth;let t=n._tooltipDiv.offsetHeight,e=parseInt(n._tooltipDiv.style.marginTop),r=parseInt(n._tooltipDiv.style.marginBottom);e&&(t+=e),r&&(t+=r),n._tooltipHeight=t}0==n._windowWidth&&(n._windowWidth=window.innerWidth,n._windowHeight=window.innerHeight),e&&e.clientY||(e=r.event.clientY?r.event:r.event.sourceEvent),n._tooltipPlacementFunc(e)}}}adjustVerticalPosition(t,e){(t-=this._tooltipHeight/2)<window.pageYOffset&&(t=window.pageYOffset),(e=t+this._tooltipHeight)>this._windowHeight+window.pageYOffset&&(t-=e-(this._windowHeight+window.pageYOffset)),t<0&&(t=0),this._tooltipDiv.style.top=t+"px"}placeTooltipLeft(t){let e,n;e=window.pageYOffset+t.clientY,n=window.pageXOffset+t.clientX,n-=this._tooltipWidth+10,n<window.pageXOffset&&(n=window.pageXOffset),this._tooltipDiv.style.left=n+"px",this.adjustVerticalPosition(e,void 0)}placeTooltipLeftRight(t){let e,n;e=window.pageYOffset+t.clientY,n=window.pageXOffset+t.clientX,n<this._windowWidth/3&&(this._tooltipLeftOfMouse=!1),n>this._windowWidth/3*2&&(this._tooltipLeftOfMouse=!0),this._tooltipLeftOfMouse?n-=this._tooltipWidth+10:n+=10,n<window.pageXOffset&&(n=window.pageXOffset),this._tooltipDiv.style.left=n+"px",this.adjustVerticalPosition(e,void 0)}defaultTooltipPlacement(t){let e,n,r,i;if(e=window.pageYOffset+t.clientY,i=window.pageXOffset+t.clientX,t.y<this._windowHeight/2){if(e+=20+this._tooltipOffset,n=e+this._tooltipHeight,n<this._windowHeight+window.pageYOffset)return i-=this._tooltipWidth/2,r=i+this._tooltipWidth,r>this._windowWidth&&(i-=r-this._windowWidth),i<window.pageXOffset&&(i=window.pageXOffset),this._tooltipDiv.style.left=i+"px",void this.adjustVerticalPosition(e,n)}else if(e-=this._tooltipHeight+10+this._tooltipOffset,e>=window.pageYOffset)return i-=this._tooltipWidth/2,r=i+this._tooltipWidth,r>this._windowWidth&&(i-=r-this._windowWidth),i<window.pageXOffset&&(i=window.pageXOffset),this._tooltipDiv.style.left=i+"px",void this.adjustVerticalPosition(e,n);t.clientX>this._windowWidth/2?(i-=this._tooltipWidth+10,i<window.pageXOffset&&(i=window.pageXOffset)):(i+=10,r=i+this._tooltipWidth,r>this._windowWidth&&(i-=r-this._windowWidth)),this._tooltipDiv.style.left=i+"px",this.adjustVerticalPosition(e,n)}setOffset(t){return this._tooltipOffset=t,this}setEnabled(t){return this._disabled=!t,this}setHideDisplayValue(t){return this._hide=t,this}setDelay(t){return this._delayMS=t,this}setPlaceTooltipLeft(){return this._tooltipPlacementFunc=this.placeTooltipLeft,this}setPlaceTooltipLeftRight(){return this._tooltipPlacementFunc=this.placeTooltipLeftRight,this}releaseListeners(){this._targets.forEach(t=>{t.on("mouseenter.tooltip",null).on("mouseleave.tooltip",null).on("mousemove.tooltip",null)}),this._targets=[]}setVisibilityTimeout(t,e=!0){return this._visibilityTimeoutSecs=t,this._visibilityTimeoutCallLeaveFunction=e,this}alwaysRecalcWidth(t){return this._alwaysRecalcWidth=t,this}setBackgroundColor(t){return this._tooltipBackgroundColor=t,this._tooltipDiv.style["background-color"]=this._tooltipBackgroundColor,this}setFontColor(t){return this._tooltipFontColor=t,this._tooltipDiv.style.color=this._tooltipFontColor,this}setFontType(t){return this._tooltipFontType=t,this._tooltipDiv.style.font=this._tooltipFontType,this}setFontSize(t){return this._tooltipFontSize=t,this._tooltipDiv.style.font=this._tooltipFontSize,this}setAnalyticsName(t){return this._analyticsName=t,this}setCssClass(t){return this._tooltipDiv.classList.add(t),this}setTarget(t){return t&&(t.on("mouseenter.tooltip",this.onMouseEnter).on("mouseleave.tooltip",this.onMouseLeave).on("mousemove.tooltip",this.onMouseMove),this._targets.push(t)),this}setEnterCallback(t){return this._enterfunc=t,this}setLeaveCallback(t){return this._leavefunc=t,this}setMoveCallback(t){return this._movefunc=t,this}displayTooltip(t){if(this._disabled)return this;let e=this;return 0===t?(n(),this):void 0!==this._timerId?this:(this._timerId=window.setTimeout(n,t),this);function n(){e._disabled||(e._tooltipDiv.style.display="block",e._visibilityTimeoutSecs>0&&(e._visibilityTimerId=window.setTimeout((function(){e.onMouseLeave(null)}),1e3*e._visibilityTimeoutSecs)))}}hideTooltip(){return this._timerId&&window.clearTimeout(this._timerId),this._timerId=void 0,this._tooltipDiv.style.display=this._hide,this}}e.BaseTooltip=i,i._defaultDelayMS=500,i._counter=0;e.OneLineTooltip=class extends i{constructor(t,e="tooltip-t"){super(t,e)}getTitle(){return this._title}setData(t,e){for(;this._tooltipDiv.hasChildNodes();)this._tooltipDiv.removeChild(this._tooltipDiv.lastChild);this._title=t;let n=document.createElement("table");n.classList.add("tooltip-table"),this._tooltipDiv.appendChild(n);let r=document.createElement("tr");n.appendChild(r);let i=document.createElement("td");i.classList.add("tooltip-title"),i.setAttribute("colspan","2"),i.textContent=t,r.appendChild(i),null!=e&&(r=document.createElement("tr"),n.appendChild(r),i=document.createElement("td"),i.setAttribute("colspan","2"),i.textContent=e,r.appendChild(i))}};class o extends i{constructor(t,e="tooltip-t"){super(t,e)}getTitle(){return this._title}setData(t,e){for(;this._tooltipDiv.hasChildNodes();)this._tooltipDiv.removeChild(this._tooltipDiv.lastChild);this._title=t;let n=document.createElement("table");n.classList.add("tooltip-table"),this._tooltipDiv.appendChild(n);let r=document.createElement("tr");n.appendChild(r);let i=document.createElement("td");i.classList.add("tooltip-title"),i.setAttribute("colspan","2"),i.textContent=t,r.appendChild(i);let o=!1;if(e.length>0){let t=e[0].source;for(let n=1;n<e.length;++n)e[n].source!==t&&(o=!0)}for(let t=0;t<e.length;++t){let r=e[t];if(Object.keys(r.metrics).length>0){let t=r.source;if(t&&t.title&&o){let e=document.createElement("tr");n.appendChild(e);let r=document.createElement("td");r.classList.add("tooltip-group-title"),r.setAttribute("colspan","2"),r.textContent=t.title,e.appendChild(r)}if(r.group&&r.group.length>0){let t=document.createElement("tr");n.appendChild(t);let e=document.createElement("td");e.classList.add("tooltip-group-title"),e.setAttribute("colspan","2"),e.textContent=r.group,t.appendChild(e)}for(let t in r.metrics){let e=document.createElement("tr");n.appendChild(e);let i=document.createElement("td");i.classList.add("tooltip-metric-name"),i.textContent=t,e.appendChild(i),i=document.createElement("td"),i.classList.add("tooltip-metric-value"),i.textContent=r.metrics[t],e.appendChild(i)}}}}}e.MetricListTooltip=o;e.CustomDivTooltip=class extends o{constructor(t,e="tooltip-t"){super(t,e)}clearTooltip(){for(;this._tooltipDiv.hasChildNodes();)this._tooltipDiv.removeChild(this._tooltipDiv.lastChild)}getTooltipDiv(){return this._tooltipDiv}}},function(t,n){t.exports=e},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(0);var o;!function(t){t[t.Tooltip=0]="Tooltip",t[t.Highlight=1]="Highlight",t[t.Render=2]="Render",t[t.Focus=3]="Focus",t[t.None=4]="None"}(o||(o={}));class a{constructor(){this._nameMap={},this._objectMap=new Map}}function s(t){t.getTooltip||(t.getTooltip=function(e){return t.renderer&&t.renderer.getTooltipData?t.renderer.getTooltipData(t,e):[{source:t,group:"",metrics:{}}]})}function l(t){t.api||(t.api={}),t.api.cursorChange||(t.api.cursorChange=function(e){if(t.renderer&&t.renderer.cursorChange)return t.renderer.cursorChange(t,e)}),t.api.hover||(t.api.hover=function(e){if(t.renderer&&t.renderer.hover)return t.renderer.hover(t,e)}),t.api.brush||(t.api.brush=function(e){if(t.renderer&&t.renderer.brush)return t.renderer.brush(t,e)}),t.api.zoom||(t.api.zoom=function(e){if(t.renderer&&t.renderer.zoom)return t.renderer.zoom(t,e)})}function h(t){t.api||(t.api={}),t.api.brush||(t.api.brush=function(e){if(t.renderer&&t.renderer.brush)return t.renderer.brush(t,e)}),t.api.render||(t.api.render=function(e,n){return e?t.renderer=e:e=t.renderer,new Promise((function(r,i){e&&(t.renderer.render(t,n),r("Ok")),i("No renderer available")}))})}function u(t){s(t),l(t),h(t)}e.GroupInfo=a,e.addCallbacks=u;e.ElementManager=class{constructor(){this._elems=[];let t=this;this._groupInfo=[];for(let t=0;t<4;++t)this._groupInfo.push(new a);this._onHoverCallback=function(e){e.caller||console.warn("Warning no caller specified for this event, cannot propoate changes",e);let n=t._groupInfo[3]._objectMap.get(e.caller);if(n)if(t._hoverCallback)t._hoverCallback(n,e);else for(let t=0;t<n.length;++t){let r=n[t];e.caller!==r&&r.api&&r.api.hover&&r.api.hover(e)}},this._onZoomCallback=function(e){e.caller||console.warn("Warning no caller specified for this event, cannot propoate changes",e);let n=t._groupInfo[1]._objectMap.get(e.caller);if(n)if(t._zoomCallback)t._zoomCallback(n,e);else for(let t=0;t<n.length;++t){let r=n[t];e.caller!==r&&r.api&&r.api.zoom&&r.api.zoom(e)}},this._onCursorChangeCallback=function(e){e.caller||console.warn("Warning no caller specified for this event, cannot propoate changes",e);let n=t._groupInfo[1]._objectMap.get(e.caller);if(n)if(t._cursorChangeCallback)t._cursorChangeCallback(n,e);else for(let t=0;t<n.length;++t){let r=n[t];e.caller!==r&&r.api&&r.api.cursorChange&&r.api.cursorChange(e)}},this._onBrushCallback=function(e){e.caller||console.warn("Warning no caller specified for this event, cannot propoate changes",e);let n=t._groupInfo[1]._objectMap.get(e.caller);if(n)if(t._brushCallback)t._brushCallback(n,e);else for(let t=0;t<n.length;++t){let r=n[t];e.caller!==r&&r.api&&r.api.brush&&r.api.brush(e)}},this._onTooltipCallback=function(e){e.caller||console.warn("Warning no caller specified for this event, cannot propoate changes",e);let n=[],r=t._groupInfo[0]._objectMap.get(e.caller);if(r){if(t._tooltipCallback)n=n.concat(t._tooltipCallback(r,e));else for(let t=0;t<r.length;++t){let i=r[t].getTooltip(e);n=n.concat(i)}return e.data&&e.data.tooltip&&e.data.tooltip.setData(e.data.tooltip.getTitle(),n),n}},this._onUpdateCallback=function(e,n){e||console.warn("Warning no caller specified for this event, cannot propoate changes");let r=t._groupInfo[2]._objectMap.get(e);if(r)for(let t=0;t<r.length;++t){let e=r[t];e.renderer&&e.renderer.render(e,n)}}}removeFromGroup(t,e){let n=this._groupInfo[e]._objectMap.get(t);n&&r.removeFromList(t,n)}addToGroup(t,e,n){this._groupInfo[n]._nameMap.hasOwnProperty(e)||(this._groupInfo[n]._nameMap[e]=[]),this._groupInfo[n]._nameMap[e].push(t),this._groupInfo[n]._objectMap.set(t,this._groupInfo[n]._nameMap[e])}addElement(t,e,n,r){if(!t)return this;if(-1!==this._elems.indexOf(t))throw"Element already exists in this manager";{let i;u(t),this._elems.push(t),t.getElements||(t.getElements=function(){return[t]}),i=t.getElements();for(let t=0;t<i.length;++t){let o=i[t];e&&this.addToTooltipGroup(o,e),n&&this.addToHighlightGroup(o,n),r&&this.addToRenderGroup(o,r)}}return t.manager=this,this}removeElement(t){if(!t)return this;let e;e=t.getElements?t.getElements():[t];for(let t=0;t<e.length;++t){let n=e[t];this.removeFromTooltipGroup(n),this.removeFromHighlightGroup(n),this.removeFromRenderGroup(n)}return r.removeFromList(t,this._elems),delete t.manager,this}getElements(){return this._elems}setZoomCallback(t){return this._zoomCallback=t,this}setHoverCallback(t){return this._hoverCallback=t,this}setTooltipCallback(t){return this._tooltipCallback=t,this}setBrushCallback(t){return this._brushCallback=t,this}addToTooltipGroup(t,e){s(t),this.removeFromTooltipGroup(t),this.addToGroup(t,e,0);let n=this;if(t.onTooltip){let e=t.onTooltip;t.onTooltip=function(t){n._onTooltipCallback(t),e(t)}}else t.onTooltip=this._onTooltipCallback;return this}removeFromTooltipGroup(t){return this.removeFromGroup(t,0),this}addToFocusGroup(t,e){l(t),this.removeFromFocusGroup(t);let n=this;if(t.onHover){let e=t.onHover;t.onHover=function(t){n._onHoverCallback(t),e(t)}}else t.onHover=n._onHoverCallback;return this.addToGroup(t,e,3),this}removeFromFocusGroup(t){return this.removeFromGroup(t,3),this}addToHighlightGroup(t,e){l(t),this.removeFromHighlightGroup(t),this.addToFocusGroup(t,e);let n=this;if(t.onBrush){let e=t.onBrush;t.onBrush=function(t){n._onBrushCallback(t),e(t)}}else t.onBrush=n._onBrushCallback;if(t.onCursorChanged){let e=t.onCursorChanged;t.onCursorChanged=function(t){n._onCursorChangeCallback(t),e(t)}}else t.onCursorChanged=this._onCursorChangeCallback;if(t.onZoom){let e=t.onZoom;t.onZoom=function(t){n._onZoomCallback(t),e(t)}}else t.onZoom=this._onZoomCallback;let o=this._groupInfo[1]._nameMap[e];if(o&&o.length){let e=o[0];if(e.api.getOptions&&t.api&&t.api.zoom){let n=e.api.getOptions(),o=r.copy(n);o.event=i.EventType.Zoom,setTimeout(()=>{t.api.zoom(o)})}}return this.addToGroup(t,e,1),this}removeFromHighlightGroup(t){return this.removeFromFocusGroup(t),this.removeFromGroup(t,1),this}addToRenderGroup(t,e){h(t),this.removeFromRenderGroup(t),this.addToGroup(t,e,2);let n=this;if(t.handleUpdate){let e=t.handleUpdate;t.handleUpdate=function(t,r){n._onUpdateCallback(t,r),e(t,r)}}else t.handleUpdate=this._onUpdateCallback;return this}removeFromRenderGroup(t){return this.removeFromGroup(t,2),this}clear(){this._elems.length=0,this._groupInfo.length=0;for(let t=0;t<4;++t)this._groupInfo.push(new a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(7),o=n(10);class a{constructor(t){this._graphicsMap={},this._renderer=t}add(t,e,n,r,i){let a;return t?(this._graphicsMap[t]||(this._graphicsMap[t]=this._renderer.generateTexture(i(),n,r)),a=new o.Sprite(this._graphicsMap[t])):(this._graphicsMap[e]||(this._graphicsMap[e]=this._renderer.generateTexture(i(),n,r)),a=new o.Sprite(this._graphicsMap[e])),a}}e.GraphicsManager=a;e.PIXIHelper=class{constructor(){this._selectionItems={},o.utils.skipHello(),this._renderer=new o.Renderer({transparent:!0,antialias:!0});let t=new o.Graphics;t.beginFill(16777215),t.drawRect(0,0,1,1),t.endFill(),this._rectTexture=this._renderer.generateTexture(t,o.SCALE_MODES.LINEAR,128)}getRenderer(){return this._renderer}createGraphicsManager(){return new a(this._renderer)}addPixiSvg(t,e,n,r){let i=t.node().getElementsByClassName(e);for(let t=0;t<i.length;++t){let e=i[t];e.parentNode.removeChild(e)}let o=t.append("foreignObject").attr("class",e).attr("width",n).attr("height",r),a=o.node().appendChild(this._renderer.view),s=function(){let t=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null==t||5!=t.length)return;let e=t.map(t=>parseInt(t,10));return{major:e[1],minor:e[2],build:e[3]}}();if(void 0!==s&&s.major<75){a.style.position="fixed",a.style.top=-window.scrollY+"px";let t=-window.scrollY,e=window.scrollY;document.addEventListener("scroll",(function(){t-=window.scrollY-e,a.style.top=t+"px",e=window.scrollY}))}return this._renderer.resize(n,r),o}createRectangleContainer(t,e,n,r,i){var a=new o.Container,s=new o.Sprite(this._rectTexture);return s.tint=i,s.width=n,s.height=r,a.addChild(s),a.position.x=t,a.position.y=e,a}renderText(t,e,n=0,r=2,i=.5){this._useWebGLRenderer||(r=1,i=1);let a=e.style("font-size");a=Number(a.substring(0,a.length-2))*r+"px";let s=new o.Text(t,{fill:n,fontFamily:e.style("font-family"),fontSize:a,fontWeight:e.style("font-weight")});return s.scale=new o.Point(i,i),s}addInteractionHelper(t,e,n,o,a,s,l,h,u){t.interactive=!0;let c,d=this;function g(t){t.stopPropagation(),l&&l.onMouseLeave(t),i.showContextMenu(t.data.originalEvent,u,o)}(e||n)&&t.on("click",(function(t){t.stopPropagation(),n?c?(window.clearTimeout(c),c=null,n({caller:h,event:r.EventType.DoubleClick,data:u})):c=setTimeout((function(){c&&(e({caller:h,event:r.EventType.Click,data:u}),c=null)}),300):e({caller:h,event:r.EventType.Click,data:u})})),o&&o.length&&t.on("rightupoutside",g).on("rightup",g),a&&t.on("mouseover",(function(t){t.target&&(this.__data__=u,a.call(this),l&&(d._tooltipTarget=t.target,l.onMouseEnter(u),l.onMouseMove(u,t.data.originalEvent)))})),s&&t.on("mouseout",(function(t){s.call(this),l&&t.currentTarget===d._tooltipTarget&&l.onMouseLeave(u)}))}clearSelections(){this._selectionItems={}}addSelection(t,e){this._selectionItems.hasOwnProperty(t)||(this._selectionItems[t]=[]),this._selectionItems[t].push(e)}getSelection(t){return this._selectionItems[t]}getStage(){return this._stage}render(t){t?(this._stage=t,this._renderer.render(t)):this._stage&&this._renderer.render(this._stage)}}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(18);function i(){let t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return r.polyfill(),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){r.polyfill(),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t});let e=t.indexOf("rv:");return parseInt(t.substring(e+3,t.indexOf(".",e)),10)}let n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}e.detectIE=i,document.addEventListener("DOMContentLoaded",(function(){i()}),!1),e.useIEPolyfill=function(t){try{new CustomEvent("test")}catch(e){let n=function(e,n){n=n||{bubbles:!1,cancelable:!1};var r=document.createEvent("MouseEvent");return r.initMouseEvent(e,n.bubbles,n.cancelable,t,0,0,0,0,0,!1,!1,!1,!1,0,null),r};n.prototype=Event.prototype,t.MouseEvent=n}}},function(t,e){t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(0),o=n(2);e.SelectionHelper=class{constructor(t,e,n=!1){this._currSelections=[],this._addSelection=t,this._removeSelection=e,this._doBlink=n}static getHoverColor(t){let e=o.color(t),n=o.color(e).darker(2).toString();return n===e.toString()&&(e.opacity=.6*e.opacity,n=e.toString()),n}_addSelectionHelper(t){let e=this;this._addSelection(t),e._doBlink&&(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout((function(){e._removeSelectionHelper(t,!0)}),500))}_removeSelectionHelper(t,e=!1){let n=this;this._removeSelection(t),this._doBlink&&e&&(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout((function(){n._addSelectionHelper(t)}),500))}onSelect(t){if(!isNaN(Number(t.selection)))return void(void 0===t.selection?console.debug("Chart unable to fire hover event with undefined selection"):0===t.selection.length?console.debug("Chart unable to fire hover event with an empty string selection"):console.debug("Chart unable to fire hover event using a number as the selection class due to CSS limitations"));let e=r.getSelectionName(t.selection),n=this._currSelections.indexOf(e);switch(t.event){case i.EventType.HoverStart:-1===n&&(this._currSelections.push(e),this._addSelectionHelper(e));break;case i.EventType.HoverEnd:-1!==n&&(clearTimeout(this._highlightTimer),this._currSelections.splice(n,1),this._removeSelectionHelper(e));break;case i.EventType.HoverClear:clearTimeout(this._highlightTimer);for(let t=0;t<this._currSelections.length;++t)this._removeSelectionHelper(this._currSelections[t]);this._currSelections=[]}}onRedraw(){for(let t=0;t<this._currSelections.length;++t){let e=this._currSelections[t];this._addSelectionHelper(e)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(26),o=n(7),a=n(19),s=n(1),l=n(9),h=n(4),u=n(3),c=n(14),d=n(2),g=n(10);class p{static addNode(t,e,n){return n.hasOwnProperty(t.key)?n[t.key]:(t.node=e.length,n[t.key]=t.node,e.push(t),t.node)}initializeGraph(t){t.nodes||(t.nodes=[]);let e={};for(let n=0;n<t.nodes.length;++n){let r=t.nodes[n];r.node=n,e[r.key]=n}for(let n=0;n<t.links.length;++n){let r=t.links[n];r.source=this.getLinkNode(r.from,t.nodes,e),r.target=this.getLinkNode(r.to,t.nodes,e)}}bind(t,e,n,i){let a,s=this;this.getSelectionString=n||(t=>t.source.key+"-"+t.target.key),this.getTooltipString=i||(t=>{let e;return t.source?e=t.source.key+" â†’ "+t.target.key+"\n"+t.value:(e=t.key+"\n",void 0!==t.value&&(e+=t.value)),e}),this.onHoverChanged=function(n){if(u.SVGRenderer.IS_RESIZING)return;t.hover(e,n);let r=e.onHover;return r&&r(n),!0},this.nodeHoverStart=function(){let t=this.__data__.key;return a=t,s.onHoverChanged({caller:e,event:r.EventType.HoverStart,selection:t})},this.linkHoverStart=function(){let t=s.getSelectionString(this.__data__);return a=t,s.onHoverChanged({caller:e,event:r.EventType.HoverStart,selection:t})},this.hoverEnd=function(){let t=s.onHoverChanged({caller:e,event:r.EventType.HoverEnd,selection:a});return a=void 0,t},this.getTooltipData=function(t){let e=t.data.data;return e&&this._dataTooltip.setData(s.getTooltipString(e),[]),[]};let h=t=>{t.def&&(t=t.def);let n={tooltip:s._dataTooltip,data:t},r=e.onTooltip;return r?r({caller:e,data:n}):this.getTooltipData({caller:e,data:n}),!0};this._dataTooltip=new l.CustomDivTooltip(this._tooltipId,"tooltip-t"),this._dataTooltip.setAnalyticsName(this._tooltipAnalyticsName).setEnterCallback(h).setMoveCallback(h).setPlaceTooltipLeftRight().alwaysRecalcWidth(!0).setDelay(0),this.getLinkNode=(t,e,n)=>"string"==typeof t||t instanceof String?p.addNode({key:t},e,n):p.addNode(t,e,n),this.getNextXY=(t,e,n,i)=>{switch(e){case r.Alignment.Bottom:case r.Alignment.Top:return n.x<i.x?{x:t.x+t.width+10,y:n.y}:{x:t.x-10,y:n.y};case r.Alignment.Left:case r.Alignment.Right:return n.y<i.y?{x:n.x,y:t.y+t.height+10}:{x:n.x,y:t.y-10}}},this.addElbow=(t,e,n,i)=>{let o=e.source.node.from===e.source.node.to,a=0;switch(e.target.alignment){case r.Alignment.Bottom:a=o?(n.y+i.y)/2:(n.y-i.y)*Math.random()+i.y,t.push({x:n.x,y:a}),t.push({x:i.x,y:a});break;case r.Alignment.Top:a=o?(n.y+i.y)/2:(i.y-n.y)*Math.random()+n.y,t.push({x:n.x,y:a}),t.push({x:i.x,y:a});break;case r.Alignment.Left:a=o?(n.x+i.x)/2:(i.x-n.x)*Math.random()+n.x,t.push({x:a,y:n.y}),t.push({x:a,y:i.y});break;case r.Alignment.Right:a=o?(n.x+i.x)/2:(n.x-i.x)*Math.random()+n.x,t.push({x:a,y:n.y}),t.push({x:a,y:i.y})}},this.getElbowLinkPath=(t,e,n)=>{let i=this,o=[],a=t.source.alignment===r.Alignment.Left&&t.target.alignment===r.Alignment.Right||t.source.alignment===r.Alignment.Right&&t.target.alignment===r.Alignment.Left||t.source.alignment===r.Alignment.Top&&t.target.alignment===r.Alignment.Bottom||t.source.alignment===r.Alignment.Bottom&&t.target.alignment===r.Alignment.Top;if(a)switch(t.source.alignment){case r.Alignment.Left:n.x>e.x&&(a=!1);break;case r.Alignment.Right:n.x<e.x&&(a=!1);break;case r.Alignment.Top:n.y>e.y&&(a=!1);break;case r.Alignment.Bottom:n.y<e.y&&(a=!1)}if(a)switch(t.target.alignment){case r.Alignment.Left:n.x<e.x&&(a=!1);break;case r.Alignment.Right:n.x>e.x&&(a=!1);break;case r.Alignment.Top:n.y<e.y&&(a=!1);break;case r.Alignment.Bottom:n.y>e.y&&(a=!1)}if(a)o.push(e),this.addElbow(o,t,e,n),o.push(n);else{let r,a;o.push(e);t.source.node;r=i.getNextXY(_(i._graphContainer,t.source.node),t.source.alignment,e,n),o.push(r),a=i.getNextXY(_(i._graphContainer,t.target.node),t.target.alignment,n,e),this.addElbow(o,t,r,a),o.push(a),o.push(n)}return o},this.configureZoom=(t,e,n,r)=>{if(this._options.disableZoomViewUpdate)return;let i=this,o=t[1]-t[0],a=e[1]-e[0],s=o/2+t[0],l=a/2+e[0],h=n/a,u=r/o,c=Math.min(1,h,u);if(i._zoom.scaleExtent([c/3,1.5]),i._options.fitToWindow){let t=d.zoomIdentity.translate(r/2-s*c,n/2-l*c).scale(c);i._graphContainer.call(i._zoom.transform,t)}i._contextMenuItems.push({title:"Reset Zoom",action(t,e,o){if(i._options.fitToWindow){let t=d.zoomIdentity.translate(r/2-s*c,n/2-l*c).scale(c);i._graphContainer.transition().duration(i.getAnimateDuration()).call(i._zoom.transform,t)}else i._graphContainer.transition().duration(i.getAnimateDuration()).call(i._zoom.transform,d.zoomIdentity)}})},this.configureBrush=()=>{let t=this;function e(e,n){if(!e)return!1;let r=t._element,i={event:n,xStart:e[0][0],xEnd:e[1][0],yStart:e[0][1],yEnd:e[1][1],caller:r},o=r.onBrush;return o?o(i):t.brush(i),!0}let n=function(e){null!==e&&t._brushTooltip.setData("Selection","("+e[0][0].toFixed(2)+", "+e[0][1].toFixed(2)+") - ("+e[1][0].toFixed(2)+", "+e[1][1].toFixed(2)+")")};t._svg.select(".brush").remove(),t._brushTooltip=new l.OneLineTooltip("brush","tooltip-t"),t._brushTooltip.setPlaceTooltipLeftRight().alwaysRecalcWidth(!0).setDelay(0),t._brush=(new u.Brush).setXY(!0).setTarget(t._svg.append("g").attr("class","brush")).setStartCallback((function(i){return t._brush.moveToFront(),n(i),t._dataTooltip.onMouseLeave(d.event),t._brushTooltip.onMouseEnter(d.event),t._brushTooltip.onMouseMove(d.event),e(i,r.EventType.BrushStart)})).setMoveCallback((function(i){return n(i),t._dataTooltip.onMouseLeave(d.event),t._brushTooltip.onMouseMove(d.event),e(i,r.EventType.BrushMove)})).setEndCallback((function(n){t._brushTooltip.onMouseLeave(d.event);let i=t._element.brushContextMenuItems;if(n&&i){let a=[];for(let t=0;t<i.length;++t){let o=i[t];a.push({title:o.title,action(t,i,a){i.xStart=n[0][0],i.xEnd=n[1][0],i.yStart=n[0][1],i.yEnd=n[1][1],o.action(t,i,a),e(n,r.EventType.BrushEnd)}})}o.showContextMenu(d.event.sourceEvent,{event:r.EventType.BrushEnd,caller:t._element},a)}else{let t=document.getElementsByClassName("context-menu");t.length>0&&(t[0].style.display="none")}return t._options.forceBrushToFront||t._brush.moveToBack(),!0})).setRect(t._svgRect).ready(),t._brush.moveToBack()}}configureView(t,e){let n=[Number.MAX_VALUE,-Number.MAX_VALUE],r=[Number.MAX_VALUE,-Number.MAX_VALUE];if(this._element.nodes.forEach((function(t){n[0]=Math.min(n[0],t.x),n[1]=Math.max(n[1],t.x),r[0]=Math.min(r[0],t.y),r[1]=Math.max(r[1],t.y)})),t=this.renderLegend(t),this.bindZoom(),this.configureZoom(n,r,t,e),this.configureContextMenu(),this._svg&&!this._options.disableBrush){let t=this;setTimeout((function(){t.configureBrush()}),0)}}}e.ConnectedGraphBase=p;e.DiagramBase=class extends p{bind(t,e){p.prototype.bind.call(this,t,e,t=>t.source.key+"-"+t.target.key,t=>{let e;return e=t.from?t.linkType&&(t.linkType&i.LinkType.Directional)===i.LinkType.Directional?t.from+" â†’ "+t.to+"\n":t.from+" â†” "+t.to+"\n":t.port?t.node.key+":"+t.port.key:t.label?t.label:t.key,e})}};class f extends u.SVGRenderer{constructor(t,e,n){super(),this.initialize(t,e,n),this._graphContainer=this._svg,p.prototype.bind.call(this,e,t)}renderLegend(t){let e=this,n=e._element;if(n.legend){let i=[];for(let t=0;t<n.nodes.length;++t){let r=n.nodes[t],o=r.type&&r.type.length>0?r.type[0]:r.key,a=e._svg.select(".node."+o);i.push({key:o,color:a.style("fill"),opacity:a.style("opacity")})}let o={},a=0;for(let t=0;t<i.length;++t){let e=i[t];o.hasOwnProperty(e.key)||(o[e.key]=!0,a=Math.max(e.key.length,a))}let s,l=10;switch(n.legend.alignment){case r.Alignment.Top:s=new u.D3Legend(this._svg,n.legend,n.title,new r.Rect(0,l,this._svgRect.width,this._svgRect.height));break;case r.Alignment.Bottom:s=new u.D3Legend(this._svg,n.legend,n.title,new r.Rect(0,this._svgRect.height-this.LEGEND_PADDING.Y.BOTTOM,this._svgRect.width,this._svgRect.height));break;case r.Alignment.Left:s=new u.D3Legend(this._svg,n.legend,n.title,new r.Rect(0,l,this._svgRect.width,this._svgRect.height));break;case r.Alignment.Right:s=new u.D3Legend(this._svg,n.legend,n.title,new r.Rect(this._svgRect.width-10*a,l,this._svgRect.width,this._svgRect.height))}s.addItems(i),s.render(),t||(t=this._options.height),n.legend.alignment!==r.Alignment.Top&&n.legend.alignment!==r.Alignment.Bottom||(t+=s.getRenderedRect().height)}return t}bindZoom(){if(this._options.disableZoomViewUpdate)return;let t=this,e=t._svg.select(".graphArea");t._zoom=d.zoom().on("zoom",(function(){e.attr("transform",d.event.transform)})),t._svg.call(t._zoom),t._element.api||(t._element.api={}),t._element.api.zoom=function(e){e.data&&t._zoom.scaleTo(t._parent,e.data)},t._element.api.pan=function(e){t._zoom.translateTo(t._parent,e.xStart,e.yStart)}}configureContextMenu(){let t=this,e=t._element;if(e.contextMenuItems)for(let n=0;n<e.contextMenuItems.length;++n)t._contextMenuItems.push(e.contextMenuItems[n]);if(t.saveImage&&t._options.enableSaveAsImage){let e={title:"Save As Image",action:function(e,n,r){t.saveImage()},disabled:!1};t._contextMenuItems.push(e)}t._contextMenuItems.length>0&&t._parent.on("contextmenu",(function(e){o.showContextMenu(d.event,void 0,t._contextMenuItems)}))}initializeGraphArea(t){this.loadOptions(t),this._svg.selectAll("*").remove();let e=this._svg.append("g").classed("graphArea",!0);return this._contextMenuItems=[],e}configureLinkHover(t,e){t.on("mouseenter",this.linkHoverStart).on("mouseleave",this.hoverEnd);let n=this._element;u.addClickHelper(t,n.onClick,n.onDoubleClick,n.contextMenuItems,this._dataTooltip,n,e.def),t.node().__data__=e}initializeLinkLayer(t){t.append("g").classed("links",!0)}renderLinkHelper(t,e,n){let r=this,o=d.line().x((function(t){return t.x})).y((function(t){return t.y})),a=d.line().x((function(t){return t.x})).y((function(t){return t.y})).curve(d.curveBasis),l=t.select(".links"),h=function(t){let e=t.def.from+"-"+t.def.to+" "+t.def.from+" "+t.def.to;if(t.def.type&&t.def.type.length>0)for(let n=0;n<t.def.type.length;++n)e+=" "+s.getSelectionName(t.def.type[n]);return e},c=function(t){if(t.def.color)return t.def.color;if(t.def.type&&t.def.type.length>0)for(let e=0;e<t.def.type.length;++e)if(r._colorMgr.hasColor(t.def.type[e]))return r._colorMgr.getColor(t.def.type[e]);return"black"};n&&e.forEach((function(e){t.selectAll("."+e.def.from+"-"+e.def.to+"."+e.def.from+"."+e.def.to).remove()})),e.forEach((function(t){let e,s=t.def,d=r.getLinkStartXY(t),g=r.getLinkEndXY(t);(s.linkType&i.LinkType.Linear)===i.LinkType.Linear?t.path=[d,g]:t.path=r.getElbowLinkPath(t,d,g),e=s.linkType&i.LinkType.Curve?a:o;let p,f,m=l.append("path").attr("d",e(t.path)).classed(h(t),!0).classed("link",!0).attr("fill","none").style("stroke",c(t)).attr("stroke-width",s.width?s.width:2);(s.linkType&i.LinkType.Directional||s.linkType&i.LinkType.Bidirectional)&&(f=t.path[t.path.length-1],p=u.Arrow.createArrow(l,4).classed(h(t),!0).classed("arrow",!0).attr("fill",c(t)).attr("transform","translate("+f.x+","+f.y+") rotate( "+u.Arrow.getAngle(t.path[t.path.length-2],f)+")")),s.linkType&i.LinkType.Bidirectional&&u.Arrow.createArrow(l,4).classed(h(t),!0).classed("arrow",!0).attr("fill",c(t)).attr("transform","translate("+t.path[0].x+","+t.path[0].y+") rotate( "+u.Arrow.getAngle(t.path[1],t.path[0])+")"),n||0===r.getAnimateDuration()||(u.animatePath(m,r.getAnimateDuration()),p&&u.Arrow.animateArrow(m,p,r.getAnimateDuration())),r.configureLinkHover(m,t),r._dataTooltip.setTarget(m)}))}configureView(){let t=this._options.height?this._options.height:400,e=this._options.width;this._svg.attr("width",e).attr("height",t),p.prototype.configureView.call(this,t,e)}}e.D3ConnectedGraphSVG=f;class m extends h.UIElementRenderer{constructor(t,e,n){super(),this._element=t,this._renderer=e,this._options={},this._contextMenuItems=[],this._tooltipId="d3-tooltip",this._tooltipAnalyticsName="d3-ui-widget-toolkit",this._parent=n,this._graphContainer=n,p.prototype.bind.call(this,e,t)}hover(t){this._selectionHelper.onSelect(t)}brush(t){}changeCursor(t){}getTooltipData(t){return[{source:this._element,group:"",metrics:{}}]}getAnimateDuration(){return void 0!==this._options.animateDuration?this._options.animateDuration:1e3}bindZoom(){if(this._options.disableZoomViewUpdate)return;let t=this,e=t._stage;t._zoom=d.zoom().on("zoom",(function(){e.itemDragging||(e.position.set(d.event.transform.x,d.event.transform.y),e.scale.set(d.event.transform.k,d.event.transform.k),t._pixiHelper.render())})),t._parent.call(t._zoom),t._element.api||(t._element.api={}),t._element.api.zoom=function(e){e.data&&t._zoom.scaleTo(t._parent,e.data)},t._element.api.pan=function(e){t._zoom.translateTo(t._parent,e.xStart,e.yStart)}}configureHover(){let t=this;this._selectionHelper=new a.SelectionHelper((function(e){if(e){let n=t._pixiHelper.getSelection(e);n&&n.forEach((function(t){t._prevTint=t.tint,t.tint=8947848,t.alpha=136})),t._pixiHelper.render()}}),(function(e){let n=t._pixiHelper.getSelection(e);n&&n.forEach((function(t){t.tint=t._prevTint,t.alpha=255})),t._pixiHelper.render()}))}configureContextMenu(){let t=this,e=t._element;if(e.contextMenuItems)for(let n=0;n<e.contextMenuItems.length;++n)t._contextMenuItems.push(e.contextMenuItems[n]);t._contextMenuItems.length>0&&t._parent.on("contextmenu",(function(e){o.showContextMenu(d.event,void 0,t._contextMenuItems)}))}initializeGraphArea(t){return this._contextMenuItems=[],s.merge(this._options,t),void 0===this._pixiHelper&&(this._pixiHelper=new c.PIXIHelper,this._pixi=this._pixiHelper.getRenderer(),this._parent.node().appendChild(this._pixi.view),this._stage=new g.Container,this._stage.interactive=!0,this.createArrowTexture(),this.configureHover()),this._stage.removeChildren(),this._stage}createArrowTexture(){let t=new g.Graphics;t.beginFill(0),t.lineStyle(0,0,0);t.moveTo(0,0),t.lineTo(9*Math.cos(1.1),9*Math.sin(1.1)),t.lineTo(-9*Math.cos(1.1),9*Math.sin(1.1)),t.lineTo(0,0),this._arrowTexture=this._pixi.generateTexture(t,g.SCALE_MODES.LINEAR,10)}createArrow(t,e,n,i,o){let a=new g.Sprite(this._arrowTexture);switch(a.anchor=new g.ObservablePoint(void 0,void 0,.5,0),a.x=e.x,a.y=e.y,a.rotation=-Math.atan2(e.x-n.x,e.y-n.y),o){case r.Alignment.Left:a.rotation+=Math.PI;break;case r.Alignment.Right:a.rotation+=-Math.PI;break;case r.Alignment.Top:a.rotation+=3*Math.PI/2;break;case r.Alignment.Bottom:a.rotation+=-Math.PI/2}t.addChild(a)}renderLinkHelper(t,e){let n=this;n._pixiLinks&&(t.removeChild(n._pixiLinks),n._pixiLinks.destroy(),t.removeChild(n._pixiArrows),n._pixiArrows.destroy()),n._pixiLinks=new g.Graphics,t.addChildAt(n._pixiLinks,0),n._pixiArrows=new g.Container,t.addChildAt(n._pixiArrows,1),e.forEach((function(t){let e=t.def;n._pixiLinks.lineStyle(2,8947848,.4);let r=n.getLinkStartXY(t),o=n.getLinkEndXY(t);if(e.linkType&i.LinkType.Linear?t.path=[r,o]:t.path=n.getElbowLinkPath(t,r,o),e.linkType&i.LinkType.Curve)n._pixiLinks.moveTo(t.path[0].x,t.path[0].y),n._pixiLinks.bezierCurveTo(t.path[1].x,t.path[1].y,t.path[t.path.length-2].x,t.path[t.path.length-2].y,t.path[t.path.length-1].x,t.path[t.path.length-1].y);else{n._pixiLinks.moveTo(t.path[0].x,t.path[0].y);for(let e=1;e<t.path.length;++e)n._pixiLinks.lineTo(t.path[e].x,t.path[e].y)}e.linkType&i.LinkType.Bidirectional&&n.createArrow(n._pixiArrows,t.path[0],t.path[1],e.linkType,t.source.alignment),(e.linkType&i.LinkType.Directional||e.linkType&i.LinkType.Bidirectional)&&n.createArrow(n._pixiArrows,t.path[t.path.length-1],t.path[t.path.length-2],e.linkType,t.target.alignment)}))}renderLegend(t){return t}configureView(){let t=this._options.height?this._options.height:400,e=this._options.width?this._options.width:this._parent.node().getBoundingClientRect().width;this._pixi.resize(e,t),p.prototype.configureView.call(this,t,e)}}function _(t,e){return void 0===e.x&&(e.d3selection||(e.d3selection=d.select(this)),s.merge(e,u.convertToSVGCoords(t,e.d3selection))),e}e.D3ConnectedGraphPixi=m,e.getCoordsAndCache=_},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Linear=1]="Linear",t[t.Elbow=2]="Elbow",t[t.Directional=4]="Directional",t[t.Bidirectional=8]="Bidirectional",t[t.Curve=16]="Curve"}(e.LinkType||(e.LinkType={})),function(t){t[t.NodeSimple=0]="NodeSimple",t[t.NodeRectangle=1]="NodeRectangle"}(e.NodeType||(e.NodeType={}))},,,function(t,e,n){"use strict";function r(){}n.r(e);var i=function(t){return null==t?r:function(){return this.querySelector(t)}};function o(){return[]}var a=function(t){return new Array(t.length)};function s(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}s.prototype={constructor:s,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function l(t,e,n,r,i,o){for(var a,l=0,h=e.length,u=o.length;l<u;++l)(a=e[l])?(a.__data__=o[l],r[l]=a):n[l]=new s(t,o[l]);for(;l<h;++l)(a=e[l])&&(i[l]=a)}function h(t,e,n,r,i,o,a){var l,h,u,c={},d=e.length,g=o.length,p=new Array(d);for(l=0;l<d;++l)(h=e[l])&&(p[l]=u="$"+a.call(h,h.__data__,l,e),u in c?i[l]=h:c[u]=h);for(l=0;l<g;++l)(h=c[u="$"+a.call(t,o[l],l,o)])?(r[l]=h,h.__data__=o[l],c[u]=null):n[l]=new s(t,o[l]);for(l=0;l<d;++l)(h=e[l])&&c[p[l]]===h&&(i[l]=h)}function u(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var c="http://www.w3.org/1999/xhtml",d={svg:"http://www.w3.org/2000/svg",xhtml:c,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},g=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),d.hasOwnProperty(e)?{space:d[e],local:t}:t};function p(t){return function(){this.removeAttribute(t)}}function f(t){return function(){this.removeAttributeNS(t.space,t.local)}}function m(t,e){return function(){this.setAttribute(t,e)}}function _(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function y(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function v(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var x=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function w(t){return function(){this.style.removeProperty(t)}}function b(t,e,n){return function(){this.style.setProperty(t,e,n)}}function M(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function k(t,e){return t.style.getPropertyValue(e)||x(t).getComputedStyle(t,null).getPropertyValue(e)}function C(t){return function(){delete this[t]}}function T(t,e){return function(){this[t]=e}}function S(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function A(t){return t.trim().split(/^|\s+/)}function D(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=A(t.getAttribute("class")||"")}function R(t,e){for(var n=D(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function N(t,e){for(var n=D(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function E(t){return function(){R(this,t)}}function P(t){return function(){N(this,t)}}function I(t,e){return function(){(e.apply(this,arguments)?R:N)(this,t)}}L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function H(){this.textContent=""}function O(t){return function(){this.textContent=t}}function G(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function B(){this.innerHTML=""}function F(t){return function(){this.innerHTML=t}}function z(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function U(){this.nextSibling&&this.parentNode.appendChild(this)}function W(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function V(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===c&&e.documentElement.namespaceURI===c?e.createElement(t):e.createElementNS(n,t)}}function Y(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var j=function(t){var e=g(t);return(e.local?Y:V)(e)};function X(){return null}function $(){var t=this.parentNode;t&&t.removeChild(this)}function q(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Z(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var J={},Q=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(J={mouseenter:"mouseover",mouseleave:"mouseout"}));function K(t,e,n){return t=tt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function tt(t,e,n){return function(r){var i=Q;Q=r;try{t.call(this,this.__data__,e,n)}finally{Q=i}}}function et(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function nt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function rt(t,e,n){var r=J.hasOwnProperty(t.type)?K:tt;return function(i,o,a){var s,l=this.__on,h=r(e,o,a);if(l)for(var u=0,c=l.length;u<c;++u)if((s=l[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=h,s.capture=n),void(s.value=e);this.addEventListener(t.type,h,n),s={type:t.type,name:t.name,value:e,listener:h,capture:n},l?l.push(s):this.__on=[s]}}function it(t,e,n){var r=x(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ot(t,e){return function(){return it(this,t,e)}}function at(t,e){return function(){return it(this,t,e.apply(this,arguments))}}var st=[null];function lt(t,e){this._groups=t,this._parents=e}function ht(){return new lt([[document.documentElement]],st)}lt.prototype=ht.prototype={constructor:lt,select:function(t){"function"!=typeof t&&(t=i(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a,s,l=e[o],h=l.length,u=r[o]=new Array(h),c=0;c<h;++c)(a=l[c])&&(s=t.call(a,a.__data__,c,l))&&("__data__"in a&&(s.__data__=a.__data__),u[c]=s);return new lt(r,this._parents)},selectAll:function(t){var e;"function"!=typeof t&&(t=null==(e=t)?o:function(){return this.querySelectorAll(e)});for(var n=this._groups,r=n.length,i=[],a=[],s=0;s<r;++s)for(var l,h=n[s],u=h.length,c=0;c<u;++c)(l=h[c])&&(i.push(t.call(l,l.__data__,c,h)),a.push(l));return new lt(i,a)},filter:function(t){var e;"function"!=typeof t&&(e=t,t=function(){return this.matches(e)});for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o)for(var a,s=n[o],l=s.length,h=i[o]=[],u=0;u<l;++u)(a=s[u])&&t.call(a,a.__data__,u,s)&&h.push(a);return new lt(i,this._parents)},data:function(t,e){if(!t)return m=new Array(this.size()),d=-1,this.each((function(t){m[++d]=t})),m;var n,r=e?h:l,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),u=new Array(a),c=new Array(a),d=0;d<a;++d){var g=i[d],p=o[d],f=p.length,m=t.call(g,g&&g.__data__,d,i),_=m.length,y=u[d]=new Array(_),v=s[d]=new Array(_);r(g,p,y,v,c[d]=new Array(f),m,e);for(var x,w,b=0,M=0;b<_;++b)if(x=y[b]){for(b>=M&&(M=b+1);!(w=v[M])&&++M<_;);x._next=w||null}}return(s=new lt(s,i))._enter=u,s._exit=c,s},enter:function(){return new lt(this._enter||this._groups.map(a),this._parents)},exit:function(){return new lt(this._exit||this._groups.map(a),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,h=e[s],u=n[s],c=h.length,d=a[s]=new Array(c),g=0;g<c;++g)(l=h[g]||u[g])&&(d[g]=l);for(;s<r;++s)a[s]=e[s];return new lt(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=u);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,h=i[o]=new Array(l),c=0;c<l;++c)(a=s[c])&&(h[c]=a);h.sort(e)}return new lt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=g(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?f:p:"function"==typeof e?n.local?v:y:n.local?_:m)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?w:"function"==typeof e?M:b)(t,e,null==n?"":n)):k(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?C:"function"==typeof e?S:T)(t,e)):this.node()[t]},classed:function(t,e){var n=A(t+"");if(arguments.length<2){for(var r=D(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?I:e?E:P)(n,e))},text:function(t){return arguments.length?this.each(null==t?H:("function"==typeof t?G:O)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?B:("function"==typeof t?z:F)(t)):this.node().innerHTML},raise:function(){return this.each(U)},lower:function(){return this.each(W)},append:function(t){var e="function"==typeof t?t:j(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:j(t),r=null==e?X:"function"==typeof e?e:i(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each($)},clone:function(t){return this.select(t?Z:q)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=et(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?rt:nt,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,h=0,u=s.length;h<u;++h)for(r=0,l=s[h];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?at:ot)(t,e))}};var ut=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},ct=function(t){return(t=ut(Math.abs(t)))?t[1]:NaN},dt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gt(t){if(!(e=dt.exec(t)))throw new Error("invalid format: "+t);var e;return new pt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function pt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}gt.prototype=pt.prototype,pt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ft,mt,_t,yt,vt=function(t,e){var n=ut(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},xt={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return vt(100*t,e)},r:vt,s:function(t,e){var n=ut(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(ft=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ut(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},wt=function(t){return t},bt=Array.prototype.map,Mt=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"],kt=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?wt:(e=bt.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?wt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(bt.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=gt(t)).fill,n=t.align,c=t.sign,d=t.symbol,g=t.zero,p=t.width,f=t.comma,m=t.precision,_=t.trim,y=t.type;"n"===y?(f=!0,y="g"):xt[y]||(void 0===m&&(m=12),_=!0,y="g"),(g||"0"===e&&"="===n)&&(g=!0,e="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?o:/[%p]/.test(y)?l:"",w=xt[y],b=/[defgprs%]/.test(y);function M(t){var i,o,l,d=v,M=x;if("c"===y)M=w(t)+M,t="";else{var k=(t=+t)<0;if(t=isNaN(t)?u:w(Math.abs(t),m),_&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&(k=!1),d=(k?"("===c?c:h:"-"===c||"("===c?"":c)+d,M=("s"===y?Mt[8+ft/3]:"")+M+(k&&"("===c?")":""),b)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){M=(46===l?a+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}f&&!g&&(t=r(t,1/0));var C=d.length+t.length+M.length,T=C<p?new Array(p-C+1).join(e):"";switch(f&&g&&(t=r(T+t,T.length?p-M.length:1/0),T=""),n){case"<":t=d+t+M+T;break;case"=":t=d+T+t+M;break;case"^":t=T.slice(0,C=T.length>>1)+d+t+M+T.slice(C);break;default:t=T+d+t+M}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,e){var n=c(((t=gt(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ct(e)/3))),i=Math.pow(10,-r),o=Mt[8+r/3];return function(t){return n(i*t)+o}}}};mt=kt({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),_t=mt.format,yt=mt.formatPrefix;var Ct={value:function(){}};function Tt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new St(r)}function St(t){this._=t}function At(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Dt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Lt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Ct,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}St.prototype=Tt.prototype={constructor:St,on:function(t,e){var n,r=this._,i=At(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=Lt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Lt(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Dt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new St(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Rt=Tt,Nt=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Et=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Nt(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var Pt=Et(Nt),It=Pt.right,Ht=(Pt.left,It);var Ot=Array.prototype,Gt=(Ot.slice,Ot.map,Math.sqrt(50)),Bt=Math.sqrt(10),Ft=Math.sqrt(2),zt=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=Ut(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function Ut(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Gt?10:o>=Bt?5:o>=Ft?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Gt?10:o>=Bt?5:o>=Ft?2:1)}function Wt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Gt?i*=10:o>=Bt?i*=5:o>=Ft&&(i*=2),e<t?-i:i}var Vt=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r},Yt=function(t,e){var n,r=t.length,i=-1,o=0;if(null==e)for(;++i<r;)(n=+t[i])&&(o+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(o+=n);return o};function jt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Xt(){}function $t(t,e){var n=new Xt;if(t instanceof Xt)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Xt.prototype=$t.prototype={constructor:Xt,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var qt=$t;function Zt(){}var Jt=qt.prototype;function Qt(t,e){var n=new Zt;if(t instanceof Zt)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}Zt.prototype=Qt.prototype={constructor:Zt,has:Jt.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Jt.remove,clear:Jt.clear,values:Jt.keys,size:Jt.size,empty:Jt.empty,each:Jt.each};var Kt=Array.prototype,te=Kt.map,ee=Kt.slice;var ne=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function re(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ie(){}var oe="\\s*([+-]?\\d+)\\s*",ae="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",se="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",le=/^#([0-9a-f]{3,8})$/,he=new RegExp("^rgb\\("+[oe,oe,oe]+"\\)$"),ue=new RegExp("^rgb\\("+[se,se,se]+"\\)$"),ce=new RegExp("^rgba\\("+[oe,oe,oe,ae]+"\\)$"),de=new RegExp("^rgba\\("+[se,se,se,ae]+"\\)$"),ge=new RegExp("^hsl\\("+[ae,se,se]+"\\)$"),pe=new RegExp("^hsla\\("+[ae,se,se,ae]+"\\)$"),fe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function me(){return this.rgb().formatHex()}function _e(){return this.rgb().formatRgb()}function ye(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=le.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ve(e):3===n?new Me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new Me(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new Me(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=he.exec(t))?new Me(e[1],e[2],e[3],1):(e=ue.exec(t))?new Me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ce.exec(t))?xe(e[1],e[2],e[3],e[4]):(e=de.exec(t))?xe(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ge.exec(t))?Se(e[1],e[2]/100,e[3]/100,1):(e=pe.exec(t))?Se(e[1],e[2]/100,e[3]/100,e[4]):fe.hasOwnProperty(t)?ve(fe[t]):"transparent"===t?new Me(NaN,NaN,NaN,0):null}function ve(t){return new Me(t>>16&255,t>>8&255,255&t,1)}function xe(t,e,n,r){return r<=0&&(t=e=n=NaN),new Me(t,e,n,r)}function we(t){return t instanceof ie||(t=ye(t)),t?new Me((t=t.rgb()).r,t.g,t.b,t.opacity):new Me}function be(t,e,n,r){return 1===arguments.length?we(t):new Me(t,e,n,null==r?1:r)}function Me(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ke(){return"#"+Te(this.r)+Te(this.g)+Te(this.b)}function Ce(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Te(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Se(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new De(t,e,n,r)}function Ae(t){if(t instanceof De)return new De(t.h,t.s,t.l,t.opacity);if(t instanceof ie||(t=ye(t)),!t)return new De;if(t instanceof De)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new De(a,s,l,t.opacity)}function De(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Le(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Re(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}ne(ie,ye,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:me,formatHex:me,formatHsl:function(){return Ae(this).formatHsl()},formatRgb:_e,toString:_e}),ne(Me,be,re(ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ke,formatHex:ke,formatRgb:Ce,toString:Ce})),ne(De,(function(t,e,n,r){return 1===arguments.length?Ae(t):new De(t,e,n,null==r?1:r)}),re(ie,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new De(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new De(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Me(Le(t>=240?t-240:t+120,i,r),Le(t,i,r),Le(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ne=function(t){return function(){return t}};function Ee(t,e){return function(n){return t+n*e}}function Pe(t){return 1==(t=+t)?Ie:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ne(isNaN(e)?n:e)}}function Ie(t,e){var n=e-t;return n?Ee(t,n):Ne(isNaN(t)?e:t)}var He=function t(e){var n=Pe(e);function r(t,e){var r=n((t=be(t)).r,(e=be(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Ie(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Oe(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=be(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}Oe((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Re((n-r/e)*e,a,i,o,s)}})),Oe((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Re((n-r/e)*e,i,o,a,s)}}));var Ge=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function Be(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Fe(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Xe(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var ze=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Ue=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},We=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Xe(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Ve=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ye=new RegExp(Ve.source,"g");var je=function(t,e){var n,r,i,o=Ve.lastIndex=Ye.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Ve.exec(t))&&(r=Ye.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Ue(n,r)})),o=Ye.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})},Xe=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Ne(e):("number"===r?Ue:"string"===r?(n=ye(e))?(e=n,He):je:e instanceof ye?He:e instanceof Date?ze:Be(e)?Ge:Array.isArray(e)?Fe:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?We:Ue)(t,e)},$e=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},qe=function(t){return+t},Ze=[0,1];function Je(t){return t}function Qe(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ke(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function tn(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Qe(i,r),o=n(a,o)):(r=Qe(r,i),o=n(o,a)),function(t){return o(r(t))}}function en(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Qe(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Ht(t,e,1,r)-1;return o[n](i[n](e))}}function nn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function rn(){var t,e,n,r,i,o,a=Ze,s=Ze,l=Xe,h=Je;function u(){return r=Math.min(a.length,s.length)>2?en:tn,i=o=null,c}function c(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(h(e)))}return c.invert=function(n){return h(e((o||(o=r(s,a.map(t),Ue)))(n)))},c.domain=function(t){return arguments.length?(a=te.call(t,qe),h===Je||(h=Ke(a)),u()):a.slice()},c.range=function(t){return arguments.length?(s=ee.call(t),u()):s.slice()},c.rangeRound=function(t){return s=ee.call(t),l=$e,u()},c.clamp=function(t){return arguments.length?(h=t?Ke(a):Je,c):h!==Je},c.interpolate=function(t){return arguments.length?(l=t,u()):l},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,u()}}function on(t,e){return rn()(t,e)}var an=function(t,e,n,r){var i,o=Wt(t,e,n);switch((r=gt(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ct(e)/3)))-ct(Math.abs(t)))}(o,a))||(r.precision=i),yt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ct(e)-ct(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-ct(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return _t(r)};function sn(t){var e=t.domain;return t.ticks=function(t){var n=e();return zt(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return an(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],l=i[a];return l<s&&(r=s,s=l,l=r,r=o,o=a,a=r),(r=Ut(s,l,n))>0?r=Ut(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=Ut(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(l/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(l*r)/r,e(i)),t},t}function ln(){var t=on(Je,Je);return t.copy=function(){return nn(t,ln())},jt.apply(t,arguments),sn(t)}var hn=new Date,un=new Date;function cn(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return cn((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return hn.setTime(+e),un.setTime(+r),t(hn),t(un),Math.floor(n(hn,un))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var dn=cn((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));dn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?cn((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var gn=dn,pn=(dn.range,cn((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));pn.range;function fn(t){return cn((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var mn=fn(0),_n=fn(1),yn=fn(2),vn=fn(3),xn=fn(4),wn=fn(5),bn=fn(6),Mn=(mn.range,_n.range,yn.range,vn.range,xn.range,wn.range,bn.range,cn((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}))),kn=Mn,Cn=(Mn.range,cn((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()}))),Tn=(Cn.range,cn((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()}))),Sn=(Tn.range,cn((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()}))),An=(Sn.range,cn((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));An.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?cn((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):An:null};An.range;function Dn(t){return cn((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var Ln=Dn(0),Rn=Dn(1),Nn=Dn(2),En=Dn(3),Pn=Dn(4),In=Dn(5),Hn=Dn(6),On=(Ln.range,Rn.range,Nn.range,En.range,Pn.range,In.range,Hn.range,cn((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1}))),Gn=On,Bn=(On.range,cn((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));Bn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?cn((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Fn=Bn;Bn.range;function zn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Un(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Wn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var Vn,Yn={"-":"",_:" ",0:"0"},jn=/^\s*\d+/,Xn=/^%/,$n=/[\\^$*+?|[\]().{}]/g;function qn(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Zn(t){return t.replace($n,"\\$&")}function Jn(t){return new RegExp("^(?:"+t.map(Zn).join("|")+")","i")}function Qn(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Kn(t,e,n){var r=jn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function tr(t,e,n){var r=jn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function er(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function nr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function rr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function ir(t,e,n){var r=jn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function or(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ar(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function sr(t,e,n){var r=jn.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function lr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function hr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ur(t,e,n){var r=jn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function cr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function dr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function gr(t,e,n){var r=jn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function pr(t,e,n){var r=jn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function fr(t,e,n){var r=jn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function mr(t,e,n){var r=Xn.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function _r(t,e,n){var r=jn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function yr(t,e,n){var r=jn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function vr(t,e){return qn(t.getDate(),e,2)}function xr(t,e){return qn(t.getHours(),e,2)}function wr(t,e){return qn(t.getHours()%12||12,e,2)}function br(t,e){return qn(1+kn.count(gn(t),t),e,3)}function Mr(t,e){return qn(t.getMilliseconds(),e,3)}function kr(t,e){return Mr(t,e)+"000"}function Cr(t,e){return qn(t.getMonth()+1,e,2)}function Tr(t,e){return qn(t.getMinutes(),e,2)}function Sr(t,e){return qn(t.getSeconds(),e,2)}function Ar(t){var e=t.getDay();return 0===e?7:e}function Dr(t,e){return qn(mn.count(gn(t)-1,t),e,2)}function Lr(t,e){var n=t.getDay();return t=n>=4||0===n?xn(t):xn.ceil(t),qn(xn.count(gn(t),t)+(4===gn(t).getDay()),e,2)}function Rr(t){return t.getDay()}function Nr(t,e){return qn(_n.count(gn(t)-1,t),e,2)}function Er(t,e){return qn(t.getFullYear()%100,e,2)}function Pr(t,e){return qn(t.getFullYear()%1e4,e,4)}function Ir(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+qn(e/60|0,"0",2)+qn(e%60,"0",2)}function Hr(t,e){return qn(t.getUTCDate(),e,2)}function Or(t,e){return qn(t.getUTCHours(),e,2)}function Gr(t,e){return qn(t.getUTCHours()%12||12,e,2)}function Br(t,e){return qn(1+Gn.count(Fn(t),t),e,3)}function Fr(t,e){return qn(t.getUTCMilliseconds(),e,3)}function zr(t,e){return Fr(t,e)+"000"}function Ur(t,e){return qn(t.getUTCMonth()+1,e,2)}function Wr(t,e){return qn(t.getUTCMinutes(),e,2)}function Vr(t,e){return qn(t.getUTCSeconds(),e,2)}function Yr(t){var e=t.getUTCDay();return 0===e?7:e}function jr(t,e){return qn(Ln.count(Fn(t)-1,t),e,2)}function Xr(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Pn(t):Pn.ceil(t),qn(Pn.count(Fn(t),t)+(4===Fn(t).getUTCDay()),e,2)}function $r(t){return t.getUTCDay()}function qr(t,e){return qn(Rn.count(Fn(t)-1,t),e,2)}function Zr(t,e){return qn(t.getUTCFullYear()%100,e,2)}function Jr(t,e){return qn(t.getUTCFullYear()%1e4,e,4)}function Qr(){return"+0000"}function Kr(){return"%"}function ti(t){return+t}function ei(t){return Math.floor(+t/1e3)}!function(t){Vn=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,h=Jn(i),u=Qn(i),c=Jn(o),d=Qn(o),g=Jn(a),p=Qn(a),f=Jn(s),m=Qn(s),_=Jn(l),y=Qn(l),v={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:vr,e:vr,f:kr,H:xr,I:wr,j:br,L:Mr,m:Cr,M:Tr,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:ti,s:ei,S:Sr,u:Ar,U:Dr,V:Lr,w:Rr,W:Nr,x:null,X:null,y:Er,Y:Pr,Z:Ir,"%":Kr},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Hr,e:Hr,f:zr,H:Or,I:Gr,j:Br,L:Fr,m:Ur,M:Wr,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:ti,s:ei,S:Vr,u:Yr,U:jr,V:Xr,w:$r,W:qr,x:null,X:null,y:Zr,Y:Jr,Z:Qr,"%":Kr},w={a:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=_.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return k(t,e,n,r)},d:hr,e:hr,f:fr,H:cr,I:cr,j:ur,L:pr,m:lr,M:dr,p:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},q:sr,Q:_r,s:yr,S:gr,u:tr,U:er,V:nr,w:Kn,W:rr,x:function(t,e,r){return k(t,n,e,r)},X:function(t,e,n){return k(t,r,e,n)},y:or,Y:ir,Z:ar,"%":mr};function b(t,e){return function(n){var r,i,o,a=[],s=-1,l=0,h=t.length;for(n instanceof Date||(n=new Date(+n));++s<h;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(i=Yn[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}}function M(t,e){return function(n){var r,i,o=Wn(1900,void 0,1);if(k(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!e||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Un(Wn(o.y,0,1))).getUTCDay(),r=i>4||0===i?Rn.ceil(r):Rn(r),r=Gn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=zn(Wn(o.y,0,1))).getDay(),r=i>4||0===i?_n.ceil(r):_n(r),r=kn.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Un(Wn(o.y,0,1)).getUTCDay():zn(Wn(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Un(o)):zn(o)}}function k(t,e,n,r){for(var i,o,a=0,s=e.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=w[i in Yn?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return(v.x=b(n,v),v.X=b(r,v),v.c=b(e,v),x.x=b(n,x),x.X=b(r,x),x.c=b(e,x),{format:function(t){var e=b(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=b(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t+="",!0);return e.toString=function(){return t},e}})}(t),Vn.format,Vn.parse,Vn.utcFormat,Vn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ni=cn((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ri=(ni.range,cn((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()}))),ii=(ri.range,cn((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})));ii.range;n.d(e,"legendColor",(function(){return ui})),n.d(e,"legendSize",(function(){return ci})),n.d(e,"legendSymbol",(function(){return di})),n.d(e,"legendHelpers",(function(){return gi}));var oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ai=function(t){return t},si=function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[r-n-1];return e},li=function(t,e){t.each((function(){for(var t,n,r="string"==typeof(n=this)?new lt([[document.querySelector(n)]],[document.documentElement]):new lt([[n]],st),i=r.text().split(/\s+/).reverse(),o=[],a=(r.attr("y"),parseFloat(r.attr("dy"))||0),s=r.text(null).append("tspan").attr("x",0).attr("dy",a+"em");t=i.pop();)o.push(t),s.text(o.join(" ")),s.node().getComputedTextLength()>e&&o.length>1&&(o.pop(),s.text(o.join(" ")),o=[t],s=r.append("tspan").attr("x",0).attr("dy",1.2+a+"em").text(t))}))},hi={d3_drawShapes:function(t,e,n,r,i,o){"rect"===t?e.attr("height",n).attr("width",r):"circle"===t?e.attr("r",i):"line"===t?e.attr("x1",0).attr("x2",r).attr("y1",0).attr("y2",0):"path"===t&&e.attr("d",o)},d3_addText:function(t,e,n,r,i){e.append("text").attr("class",r+"label");var o=t.selectAll("g."+r+"cell text."+r+"label").data(n).text(ai);return i&&t.selectAll("g."+r+"cell text."+r+"label").call(li,i),o},d3_calcType:function(t,e,n,r,i,o){var a=t.invertExtent?function(t,e,n){var r=t.range().map((function(r){var i=t.invertExtent(r);return e(i[0])+" "+n+" "+e(i[1])}));return{data:t.range(),labels:r,feature:ai}}(t,i,o):t.ticks?function(t,e,n){var r=[];if(e.length>1)r=e;else for(var i=t.domain(),o=(i[i.length-1]-i[0])/(e-1),a=0;a<e;a++)r.push(i[0]+a*o);var s=r.map(n);return{data:r,labels:s,feature:function(e){return t(e)}}}(t,n,i):function(t){return{data:t.domain(),labels:t.domain(),feature:function(e){return t(e)}}}(t),s=t.range&&t.range()||t.domain();return a.labels=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[4];if("object"===(void 0===e?"undefined":oi(e))){if(0===e.length)return t;for(var o=e.length;o<t.length;o++)e.push(t[o]);return e}if("function"==typeof e){for(var a=[],s=t.length,l=0;l<s;l++)a.push(e({i:l,genLength:s,generatedLabels:t,domain:n,range:r,labelDelimiter:i}));return a}return t}(a.labels,r,t.domain(),s,o),e&&(a.labels=si(a.labels),a.data=si(a.data)),a},d3_filterCells:function(t,e){var n=t.data.map((function(e,n){return{data:e,label:t.labels[n]}})).filter(e),r=n.map((function(t){return t.data})),i=n.map((function(t){return t.label}));return t.data=t.data.filter((function(t){return-1!==r.indexOf(t)})),t.labels=t.labels.filter((function(t){return-1!==i.indexOf(t)})),t},d3_placement:function(t,e,n,r,i,o,a){e.attr("transform",n),r.attr("transform",i),"horizontal"===t&&"below"===a&&r.style("text-anchor",o)},d3_addEvents:function(t,e){t.on("mouseover.legend",(function(t){!function(t,e,n){t.call("cellover",n,e)}(e,t,this)})).on("mouseout.legend",(function(t){!function(t,e,n){t.call("cellout",n,e)}(e,t,this)})).on("click.legend",(function(t){!function(t,e,n){t.call("cellclick",n,e)}(e,t,this)})).on("contextmenu.legend",(function(t){!function(t,e,n){t.call("cellcontextmenu",n,e)}(e,t,this)}))},d3_title:function(t,e,n,r){if(""!==e){t.selectAll("text."+n+"legendTitle").data([e]).enter().append("text").attr("class",n+"legendTitle"),t.selectAll("text."+n+"legendTitle").text(e),r&&t.selectAll("text."+n+"legendTitle").call(li,r);var i=t.select("."+n+"legendCells"),o=t.select("."+n+"legendTitle").nodes().map((function(t){return t.getBBox().height}))[0],a=-i.nodes().map((function(t){return t.getBBox().x}))[0];i.attr("transform","translate("+a+","+o+")")}},d3_defaultLocale:{format:_t,formatPrefix:yt},d3_defaultFormatSpecifier:".01f",d3_defaultDelimiter:"to"};function ui(){var t=ln(),e="rect",n=15,r=15,i=10,o=2,a=[5],s=void 0,l=[],h="",u=!1,c="",d=hi.d3_defaultLocale,g=hi.d3_defaultFormatSpecifier,p=10,f="middle",m="below",_=hi.d3_defaultDelimiter,y=void 0,v="vertical",x=!1,w=void 0,b=void 0,M=Rt("cellover","cellout","cellclick","cellcontextmenu");function k(k){var C=hi.d3_calcType(t,x,a,l,d.format(g),_);k.selectAll("g").data([t]).enter().append("g").attr("class",h+"legendCells"),s&&hi.d3_filterCells(C,s);var T=k.select("."+h+"legendCells").selectAll("."+h+"cell").data(C.data),S=T.enter().append("g").attr("class",h+"cell");S.append(e).attr("class",h+"swatch");var A=k.selectAll("g."+h+"cell "+e+"."+h+"swatch").data(C.data);hi.d3_addEvents(S,M),T.exit().transition().style("opacity",0).remove(),A.exit().transition().style("opacity",0).remove(),A=A.merge(A),hi.d3_drawShapes(e,A,r,n,i,w);var D=hi.d3_addText(k,S,C.labels,h,y);T=S.merge(T);var L=D.nodes().map((function(t){return t.getBBox()})),R=A.nodes().map((function(t){return t.getBBox()}));u?A.attr("class",(function(t){return h+"swatch "+C.feature(t)})):"line"==e?A.style("stroke",C.feature):A.style("fill",C.feature);var N=void 0,E=void 0,P="start"==f?0:"middle"==f?.5:1;if("vertical"===v){var I=L.map((function(t,e){return Math.max(t.height,R[e].height)}));N=function(t,e){return"translate(0, "+(Yt(I.slice(0,e))+e*o)+")"},E=function(t,e){return"translate( "+(R[e].width+R[e].x+p)+", "+(R[e].y+R[e].height/2+5)+")"}}else"horizontal"===v&&(N=function(t,e){return"translate("+e*(R[e].width+o)+",0)"},"below"===m?E=function(t,e){return"translate("+(R[e].width*P+R[e].x)+",\n          "+(R[e].height+R[e].y+p+8)+")"}:"right"===m&&(E=function(t,e){return"translate("+(R[e].width+R[e].x+4)+",\n            "+(R[e].height+R[e].y)+")"}));hi.d3_placement(v,T,N,D,E,f,m),hi.d3_title(k,c,h,b),T.transition().style("opacity",1)}return k.scale=function(e){return arguments.length?(t=e,k):t},k.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(a=t),k):a},k.cellFilter=function(t){return arguments.length?(s=t,k):s},k.shape=function(t,n){return arguments.length?(("rect"==t||"circle"==t||"line"==t||"path"==t&&"string"==typeof n)&&(e=t,w=n),k):e},k.shapeWidth=function(t){return arguments.length?(n=+t,k):n},k.shapeHeight=function(t){return arguments.length?(r=+t,k):r},k.shapeRadius=function(t){return arguments.length?(i=+t,k):i},k.shapePadding=function(t){return arguments.length?(o=+t,k):o},k.labels=function(t){return arguments.length?(l=t,k):l},k.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(f=t),k):f},k.labelPosition=function(t){return arguments.length?("below"!=t&&"right"!=t||(m=t),k):m},k.locale=function(t){return arguments.length?(d=kt(t),k):d},k.labelFormat=function(t){return arguments.length?(g=gt(t),k):k.locale().format(g)},k.labelOffset=function(t){return arguments.length?(p=+t,k):p},k.labelDelimiter=function(t){return arguments.length?(_=t,k):_},k.labelWrap=function(t){return arguments.length?(y=t,k):y},k.useClass=function(t){return arguments.length?(!0!==t&&!1!==t||(u=t),k):u},k.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(v=t),k):v},k.ascending=function(t){return arguments.length?(x=!!t,k):x},k.classPrefix=function(t){return arguments.length?(h=t,k):h},k.title=function(t){return arguments.length?(c=t,k):c},k.titleWidth=function(t){return arguments.length?(b=t,k):b},k.textWrap=function(t){return arguments.length?(textWrap=t,k):textWrap},k.on=function(){var t=M.on.apply(M,arguments);return t===M?k:t},k}function ci(){var t=ln(),e="rect",n=15,r=2,i=[5],o=void 0,a=[],s="",l="",h=hi.d3_defaultLocale,u=hi.d3_defaultFormatSpecifier,c=10,d="middle",g=hi.d3_defaultDelimiter,p=void 0,f="vertical",m=!1,_=void 0,y=void 0,v=Rt("cellover","cellout","cellclick","cellcontextmenu");function x(x){var w=hi.d3_calcType(t,m,i,a,h.format(u),g),b=x.selectAll("g").data([t]);o&&hi.d3_filterCells(w,o),b.enter().append("g").attr("class",s+"legendCells");var M=x.select("."+s+"legendCells").selectAll("."+s+"cell").data(w.data),k=M.enter().append("g").attr("class",s+"cell");k.append(e).attr("class",s+"swatch");var C=x.selectAll("g."+s+"cell "+e+"."+s+"swatch");hi.d3_addEvents(k,v),M.exit().transition().style("opacity",0).remove(),C.exit().transition().style("opacity",0).remove(),C=C.merge(C),"line"===e?(hi.d3_drawShapes(e,C,0,n),C.attr("stroke-width",w.feature)):hi.d3_drawShapes(e,C,w.feature,w.feature,w.feature,_);var T=hi.d3_addText(x,k,w.labels,s,p);M=k.merge(M);var S=T.nodes().map((function(t){return t.getBBox()})),A=C.nodes().map((function(n,r){var i=n.getBBox(),o=t(w.data[r]);return"line"===e&&"horizontal"===f?i.height=i.height+o:"line"===e&&"vertical"===f&&(i.width=i.width),i})),D=Vt(A,(function(t){return t.height+t.y})),L=Vt(A,(function(t){return t.width+t.x})),R=void 0,N=void 0,E="start"==d?0:"middle"==d?.5:1;if("vertical"===f){var P=S.map((function(t,e){return Math.max(t.height,A[e].height)})),I="circle"==e||"line"==e?A[0].height/2:0;R=function(t,e){var n=Yt(P.slice(0,e));return"translate(0, "+(I+n+e*r)+")"},N=function(t,e){return"translate( "+(L+c)+",\n          "+(A[e].y+A[e].height/2+5)+")"}}else if("horizontal"===f){R=function(t,n){return"translate("+(Yt(A.slice(0,n),(function(t){return t.width}))+n*r)+", "+("circle"==e||"line"==e?D/2:0)+")"};var H="line"==e?D/2:D;N=function(t,e){return"translate( "+(A[e].width*E+A[e].x)+",\n              "+(H+c)+")"}}hi.d3_placement(f,M,R,T,N,d),hi.d3_title(x,l,s,y),M.transition().style("opacity",1)}return x.scale=function(e){return arguments.length?(t=e,x):t},x.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(i=t),x):i},x.cellFilter=function(t){return arguments.length?(o=t,x):o},x.shape=function(t,n){return arguments.length?("rect"!=t&&"circle"!=t&&"line"!=t||(e=t,_=n),x):e},x.shapeWidth=function(t){return arguments.length?(n=+t,x):n},x.shapePadding=function(t){return arguments.length?(r=+t,x):r},x.labels=function(t){return arguments.length?(a=t,x):a},x.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(d=t),x):d},x.locale=function(t){return arguments.length?(h=kt(t),x):h},x.labelFormat=function(t){return arguments.length?(u=gt(t),x):x.locale().format(u)},x.labelOffset=function(t){return arguments.length?(c=+t,x):c},x.labelDelimiter=function(t){return arguments.length?(g=t,x):g},x.labelWrap=function(t){return arguments.length?(p=t,x):p},x.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(f=t),x):f},x.ascending=function(t){return arguments.length?(m=!!t,x):m},x.classPrefix=function(t){return arguments.length?(s=t,x):s},x.title=function(t){return arguments.length?(l=t,x):l},x.titleWidth=function(t){return arguments.length?(y=t,x):y},x.on=function(){var t=v.on.apply(v,arguments);return t===v?x:t},x}function di(){var t=ln(),e=5,n=[5],r=void 0,i=[],o="",a="",s=hi.d3_defaultLocale,l=hi.d3_defaultFormatSpecifier,h="middle",u=10,c=hi.d3_defaultDelimiter,d=void 0,g="vertical",p=!1,f=void 0,m=Rt("cellover","cellout","cellclick","cellcontextmenu");function _(_){var y=hi.d3_calcType(t,p,n,i,s.format(l),c),v=_.selectAll("g").data([t]);r&&hi.d3_filterCells(y,r),v.enter().append("g").attr("class",o+"legendCells");var x=_.select("."+o+"legendCells").selectAll("."+o+"cell").data(y.data),w=x.enter().append("g").attr("class",o+"cell");w.append("path").attr("class",o+"swatch");var b=_.selectAll("g."+o+"cell path."+o+"swatch");hi.d3_addEvents(w,m),x.exit().transition().style("opacity",0).remove(),b.exit().transition().style("opacity",0).remove(),b=b.merge(b),hi.d3_drawShapes("path",b,15,15,10,y.feature);var M=hi.d3_addText(_,w,y.labels,o,d);x=w.merge(x);var k=M.nodes().map((function(t){return t.getBBox()})),C=b.nodes().map((function(t){return t.getBBox()})),T=Vt(C,(function(t){return t.height})),S=Vt(C,(function(t){return t.width})),A=void 0,D=void 0,L="start"==h?0:"middle"==h?.5:1;if("vertical"===g){var R=k.map((function(t,e){return Math.max(T,t.height)}));A=function(t,n){return"translate(0, "+(Yt(R.slice(0,n))+n*e)+" )"},D=function(t,e){return"translate( "+(S+u)+",\n              "+(C[e].y+C[e].height/2+5)+")"}}else"horizontal"===g&&(A=function(t,n){return"translate( "+n*(S+e)+",0)"},D=function(t,e){return"translate( "+(C[e].width*L+C[e].x)+",\n              "+(T+u)+")"});hi.d3_placement(g,x,A,M,D,h),hi.d3_title(_,a,o,f),x.transition().style("opacity",1)}return _.scale=function(e){return arguments.length?(t=e,_):t},_.cells=function(t){return arguments.length?((t.length>1||t>=2)&&(n=t),_):n},_.cellFilter=function(t){return arguments.length?(r=t,_):r},_.shapePadding=function(t){return arguments.length?(e=+t,_):e},_.labels=function(t){return arguments.length?(i=t,_):i},_.labelAlign=function(t){return arguments.length?("start"!=t&&"end"!=t&&"middle"!=t||(h=t),_):h},_.locale=function(t){return arguments.length?(s=kt(t),_):s},_.labelFormat=function(t){return arguments.length?(l=gt(t),_):_.locale().format(l)},_.labelOffset=function(t){return arguments.length?(u=+t,_):u},_.labelDelimiter=function(t){return arguments.length?(c=t,_):c},_.labelWrap=function(t){return arguments.length?(d=t,_):d},_.orient=function(t){return arguments.length?("horizontal"!=(t=t.toLowerCase())&&"vertical"!=t||(g=t),_):g},_.ascending=function(t){return arguments.length?(p=!!t,_):p},_.classPrefix=function(t){return arguments.length?(o=t,_):o},_.title=function(t){return arguments.length?(a=t,_):a},_.titleWidth=function(t){return arguments.length?(f=t,_):f},_.on=function(){var t=m.on.apply(m,arguments);return t===m?_:t},_}var gi={thresholdLabels:function(t){var e=t.i,n=t.genLength,r=t.generatedLabels,i=t.labelDelimiter;return 0===e?"Less than "+r[e].split(" "+i+" ")[1]:e===n-1?r[e].split(" "+i+" ")[0]+" or more":r[e]}},pi={legendColor:ui,legendSize:ci,legendSymbol:di,legendHelpers:gi};e.default=pi},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(3),o=n(4),a=n(2),s=n(20);class l extends s.D3ConnectedGraphSVG{constructor(t,e,n){super(t,e,n),s.ConnectedGraphBase.prototype.initializeGraph.call(this,t);let r=this._element;r.links.forEach((function(t){"number"==typeof t.source&&(t.source=r.nodes[t.source]),"number"==typeof t.target&&(t.target=r.nodes[t.target])}))}renderLinks(t){let e=this._element,n=t.append("g").classed("links",!0).selectAll("line").data(e.links).enter().append("line").attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})).attr("stroke-width",1).attr("class",(function(t){return t.source.key+"-"+t.target.key+" "+t.source.key+" "+t.target.key})).classed("link",!0).on("mouseenter",this.linkHoverStart).on("mouseleave",this.hoverEnd);return i.addClickHelper(n,e.onClick,e.onDoubleClick,e.contextMenuItems,this._dataTooltip,e),this._dataTooltip.setTarget(n),n}renderNodes(t,e,n,r){let o=this._element,s=this._renderer.getColorManager(),l=t.append("g").classed("nodes",!0).selectAll("circle").data(o.nodes).enter().append("circle").attr("r",5).attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("fill",(function(t){return t.type?s.getColor(t.type):s.getColor(t.key)})).attr("class",(function(t){return t.type?t.type+" "+t.key:t.key})).classed("node",!0).on("mouseenter",this.nodeHoverStart).on("mouseleave",this.hoverEnd).call(a.drag().on("start",e).on("drag",n).on("end",r));return i.addClickHelper(l,o.onClick,o.onDoubleClick,o.contextMenuItems,this._dataTooltip,o),this._dataTooltip.setTarget(l),l}render(t){let e=this.initializeGraphArea(t);this.renderLinks(e),this.renderNodes(e,void 0,(function(t){a.select(this).attr("cx",a.event.x).attr("cy",a.event.y),t.x=a.event.x,t.y=a.event.y,e.selectAll("."+t.key+".link").each((function(e){t.key===e.source.key?a.select(this).attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})):a.select(this).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y}))}))}),void 0),this.configureView()}}e.D3SimpleGraph=l,o.D3Renderer.register(r.UIType.SimpleGraph,l)},,,,,function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(26)),r(n(0)),r(n(13)),r(n(8)),r(n(1)),r(n(17)),r(n(4)),r(n(3)),r(n(36)),r(n(37)),r(n(39)),r(n(40)),r(n(30))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(30),o=n(4),a=n(2),s=n(20);class l extends i.D3SimpleGraph{constructor(t,e,n){super(t,e,n),s.ConnectedGraphBase.prototype.initializeGraph.call(this,t)}render(t){let e=this._element;this._options.height||(this._options.height=400);let n=this._options.width,r=this._options.height;var i=a.forceSimulation().force("link",a.forceLink().id((function(t){return t.node}))).force("charge",a.forceManyBody()).force("center",a.forceCenter(n/2,r/2));i.nodes(e.nodes).on("tick",(function(){s.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),l.attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y}))})),i.force("link").links(e.links);let o=this.initializeGraphArea(t),s=this.renderLinks(o),l=this.renderNodes(o,(function(t){a.event.active||i.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}),(function(t){t.fx=a.event.x,t.fy=a.event.y}),(function(t){a.event.active||i.alphaTarget(0),t.fx=null,t.fy=null}));this.configureView()}}e.D3ForceGraph=l,o.D3Renderer.register(r.UIType.ForceDirectedGraph,l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(3),o=n(4),a=n(2),s=n(38),l=n(20);class h extends l.D3ConnectedGraphSVG{constructor(t,e,n){super(t,e,n),l.ConnectedGraphBase.prototype.initializeGraph.call(this,t)}renderLinks(t){let e=this._element;var n=this._sankey.link(),r=t.append("g").classed("links",!0).selectAll(".link").data(e.links).enter().append("path").attr("class",(function(t){return t.from+"-"+t.to})).attr("d",n).classed("link",!0).style("stroke-width",(function(t){return Math.max(1,t.dy)})).sort((function(t,e){return e.dy-t.dy})).on("mouseenter",this.linkHoverStart).on("mouseleave",this.hoverEnd);return i.addClickHelper(r,e.onClick,e.onDoubleClick,e.contextMenuItems,this._dataTooltip,e),this._dataTooltip.setTarget(r),r}renderNodes(t,e){let n=this._element,r=this._options.width;var o=t.append("g").classed("nodes",!0).selectAll(".nodeGroup").data(n.nodes).enter().append("g").classed("nodeGroup",!0).attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})).call(a.drag().subject((function(t){return t})).on("start",(function(){i.SVGRenderer.IS_RESIZING=!0,this.parentNode.appendChild(this)})).on("drag",e).on("end",(function(){i.SVGRenderer.IS_RESIZING=!1})));i.addClickHelper(o,n.onClick,n.onDoubleClick,n.contextMenuItems,this._dataTooltip,n);let s=this._renderer.getColorManager();return o.append("rect").attr("height",(function(t){return t.dy})).attr("width",this._sankey.nodeWidth()).attr("class",(function(t){return t.type?t.type+" "+t.key:t.key})).classed("node",!0).style("fill",(function(t){return t.type?s.getColor(t.type):s.getColor(t.key)})).style("stroke",(function(t){return a.rgb(t.color).darker(2)})).on("mouseenter",this.nodeHoverStart).on("mouseleave",this.hoverEnd),o.append("text").attr("x",-6).attr("y",(function(t){return t.dy/2})).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text((function(t){return t.key})).filter((function(t){return t.x<r/2})).attr("x",6+this._sankey.nodeWidth()).attr("text-anchor","start"),this._dataTooltip.setTarget(o),o}render(t){let e=this,n=e._element;this._options.height||(this._options.height=400);let r=this._options.width,i=this._options.height;void 0!==a.sankey?e._sankey=a.sankey().size([r,i]):e._sankey=s.sankey().size([r,i]);var o=e._sankey.link();this._sankey.nodes(n.nodes).links(n.links).layout(32);let l=e.initializeGraphArea(t),h=this.renderLinks(l);this.renderNodes(l,(function(t){a.select(this).attr("transform","translate("+(t.x=Math.max(0,Math.min(r-t.dx,a.event.x)))+","+(t.y=Math.max(0,Math.min(i-t.dy,a.event.y)))+")"),e._sankey.relayout(),h.attr("d",o)})),e.configureView()}}e.D3SankeyDiagram=h,o.D3Renderer.register(r.UIType.FlowDiagram,h)},function(t,e){t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1),o=n(3),a=n(20),s=n(4);class l extends a.D3ConnectedGraphSVG{constructor(t,e,n){super(t,e,n),this._options.width=void 0,this._nodes={},this._graphRect=this._svgRect;let i=this;this.getLinkStartXY=function(t){let e=this._nodes[t.source.node.def.key],n=a.getCoordsAndCache(i._svg,e),o={x:void 0,y:void 0},s=0;switch(t.source.alignment){case r.Alignment.Bottom:s=t.source.endPoint*((n.right-n.x)/(e.ports.bottom.length+1)),o.x=n.x+s,o.y=n.bottom;break;case r.Alignment.Top:s=t.source.endPoint*((n.right-n.x)/(e.ports.top.length+1)),o.x=n.x+s,o.y=n.y;break;case r.Alignment.Left:s=t.source.endPoint*((n.bottom-n.y)/(e.ports.left.length+1)),o.x=n.x,o.y=n.y+s;break;case r.Alignment.Right:s=t.source.endPoint*((n.bottom-n.y)/(e.ports.right.length+1)),o.x=n.right,o.y=n.y+s}return o},this.getLinkEndXY=function(t){let e=this._nodes[t.target.node.def.key],n=a.getCoordsAndCache(i._svg,e),o={x:void 0,y:void 0},s=0;switch(t.target.alignment){case r.Alignment.Bottom:s=t.target.endPoint*((n.right-n.x)/(e.ports.bottom.length+1)),o.x=n.x+s,o.y=n.bottom;break;case r.Alignment.Top:s=t.target.endPoint*((n.right-n.x)/(e.ports.top.length+1)),o.x=n.x+s,o.y=n.y;break;case r.Alignment.Left:s=t.target.endPoint*((n.bottom-n.y)/(e.ports.left.length+1)),o.x=n.x,o.y=n.y+s;break;case r.Alignment.Right:s=t.target.endPoint*((n.bottom-n.y)/(e.ports.right.length+1)),o.x=n.right,o.y=n.y+s}return o}}static isNodeRendered(t){return t.d3selection}getRectPropertyMax(t,e){let n=0;if(t)for(let r=0;r<t.length;++r){let i=this._nodes[t[r].key];l.isNodeRendered(i)&&(n=Math.max(i.rect[e],n))}return n}getStylePropertyMax(t,e){let n=0;if(t)for(let r=0;r<t.length;++r){let i=this._nodes[t[r].key];if(l.isNodeRendered(i)){let t=parseInt(o.getStyle(i.d3selection)[e]);n=Math.max(t,n)}}return n}sumVertical(t,e){let n=0;if(t){let r,i=0,a=0,s=!1;for(let h=0;h<t.length;++h){let u=this._nodes[t[h].key];if(l.isNodeRendered(u)){s&&(r=parseInt(o.getStyle(u.d3selection)["margin-top"]),i=r||e,i>a&&(n+=i-a));let t=o.convertToSVGCoords(this._svg,u.d3selection);n+=Math.max(t.height,u.rect.height),r=parseInt(o.getStyle(u.d3selection)["margin-bottom"]),a=r||e,n+=a,s=!0}}s&&(n-=a)}return n}transformVerticalNodes(t,e,n,r){let i=!1;if(n){let a,s=0,h=0,u=!1;for(let c=0;c<n.length;++c){let d=this._nodes[n[c].key];if(l.isNodeRendered(d)){i=!0;let n=o.convertToSVGCoords(this._svg,d.d3selection),l=t-Math.max(n.width,d.rect.width)/2;if(u){let t=parseInt(o.getStyle(d.d3selection)["margin-top"]);s=t||r,s>h&&(e+=s-h)}d.d3selection.transition().duration(this.getAnimateDuration()).attr("transform","translate("+l+", "+e+")"),d.rect.x=l,d.rect.y=e,e+=d.rect.height,a=parseInt(o.getStyle(d.d3selection)["margin-bottom"]),h=a||r,e+=h,u=!0}}}return i}sumHorizontal(t,e){let n=0;if(t){let r,i=0,a=0,s=!1;for(let h=0;h<t.length;++h){let u=this._nodes[t[h].key];if(l.isNodeRendered(u)){s&&(r=parseInt(o.getStyle(u.d3selection)["margin-left"]),i=r||e,i>a&&(n+=i-a));let t=o.convertToSVGCoords(this._svg,u.d3selection);n+=Math.max(t.width,u.rect.width),r=parseInt(o.getStyle(u.d3selection)["margin-right"]),a=r||e,n+=a,s=!0}}s&&(n-=a)}return n}transformHorizontalNodes(t,e,n,r){let i=!1;if(n){let a,s=0,h=0,u=!1;for(let c=0;c<n.length;++c){let d=this._nodes[n[c].key];if(l.isNodeRendered(d)){i=!0;let n=o.convertToSVGCoords(this._svg,d.d3selection),l=e-Math.max(n.height,d.rect.height)/2;if(u){let e=parseInt(o.getStyle(d.d3selection)["margin-left"]);s=e||r,s>h&&(t+=s-h)}d.d3selection.transition().duration(this.getAnimateDuration()).attr("transform","translate("+t+", "+l+")"),d.rect.x=t,d.rect.y=l,t+=d.rect.width,a=parseInt(o.getStyle(d.d3selection)["margin-right"]),h=a||r,t+=h,u=!0}}}return i}calculateNodeWidth(t,e,n,r,i,a,s,l,h){let u=0;u=Math.max(u,e.width),u=Math.max(u,r.width),u=Math.max(u,n.width),u=Math.max(u,s.width);let c=0;return 0!==i.width?(c=i.width,0!==r.width?(c+=Math.max(l,Math.max(this.getStylePropertyMax(t.left,"margin-right"),parseInt(o.getStyle(this._nodes[t.center[0].key].d3selection)["margin-left"]))),c+=r.width,0!==a.width&&(c+=Math.max(l,Math.max(parseInt(o.getStyle(this._nodes[t.center[t.center.length-1].key].d3selection)["margin-right"],this.getStylePropertyMax(t.right,"margin-left")))),c+=a.width)):0!==a.width&&(c+=Math.max(l,Math.max(this.getStylePropertyMax(t.left,"margin-right"),this.getStylePropertyMax(t.right,"margin-left"))),c+=a.width)):0!==r.width?(0!==a.width&&(c+=Math.max(l,Math.max(parseInt(o.getStyle(this._nodes[t.center[t.center.length-1].key].d3selection)["margin-right"],this.getStylePropertyMax(t.right,"margin-left")))),c+=a.width),c+=r.width):c=a.width,u=Math.max(c,u),u+=Math.max(h,parseInt(o.getStyle(this._nodes[t.key].d3selection).paddingLeft)),u+=Math.max(h,parseInt(o.getStyle(this._nodes[t.key].d3selection).paddingRight)),u}calculateNodeHeight(t,e,n,r,i,a,s,l,h){let u=0,c=0,d=0,g=0;0!==i.height&&(u=i.height,0!==e.height&&(u+=Math.max(l,Math.max(this.getStylePropertyMax(t.top,"margin-bottom"),parseInt(o.getStyle(this._nodes[t.left[0].key].d3selection)["margin-top"]))),u+=e.height),0!==n.height&&(u+=Math.max(l,Math.max(parseInt(o.getStyle(this._nodes[t.left[t.left.length-1].key].d3selection)["margin-bottom"],this.getStylePropertyMax(t.bottom,"margin-top")))),u+=n.height)),0!==r.height&&(c=r.height,0!==e.height&&(c+=Math.max(l,Math.max(this.getStylePropertyMax(t.top,"margin-bottom"),this.getStylePropertyMax(t.center,"margin-top"))),c+=e.height),0!==n.height&&(c+=n.height,c+=Math.max(l,Math.max(this.getStylePropertyMax(t.center,"margin-bottom"),this.getStylePropertyMax(t.bottom,"margin-top"))))),0!==a.height&&(d=a.height,0!==e.height&&(d+=e.height,d+=Math.max(l,Math.max(this.getStylePropertyMax(t.top,"margin-bottom"),parseInt(o.getStyle(this._nodes[t.right[0].key].d3selection)["margin-top"])))),0!==n.height&&(d+=n.height,d+=Math.max(l,Math.max(parseInt(o.getStyle(this._nodes[t.right[t.right.length-1].key].d3selection)["margin-bottom"],this.getStylePropertyMax(t.bottom,"margin-top")))))),e.height&&n.height&&(g=e.height+n.height,g+=Math.max(l,Math.max(this.getStylePropertyMax(t.top,"margin-bottom"),this.getStylePropertyMax(t.bottom,"margin-top"))));let p=0;return p=Math.max(p,e.height),p=Math.max(p,n.height),p=Math.max(p,g),p=Math.max(p,u),p=Math.max(p,c),p=Math.max(p,d),s.height&&(p+=s.height),p+=Math.max(h,parseInt(o.getStyle(this._nodes[t.key].d3selection).paddingTop)),p+=Math.max(h,parseInt(o.getStyle(this._nodes[t.key].d3selection).paddingBottom)),p}transformNode(t,e,n,i,a){let s=this,l=s._nodes[t.key],h=new r.Rect(0,0,0,0),u=parseInt(o.getStyle(l.d3selection)["margin-top"]);i=u||i;let c=parseInt(o.getStyle(l.d3selection)["padding-top"]);a=c||a;let d=new r.Rect(0,0,s.sumHorizontal(t.top,i),s.getRectPropertyMax(t.top,"height")),g=new r.Rect(0,0,s.sumHorizontal(t.bottom,i),s.getRectPropertyMax(t.bottom,"height")),p=new r.Rect(0,0,s.getRectPropertyMax(t.left,"width"),s.sumVertical(t.left,i)),f=new r.Rect(0,0,s.getRectPropertyMax(t.right,"width"),s.sumVertical(t.right,i)),m=new r.Rect(0,0,s.sumHorizontal(t.center,i),s.getRectPropertyMax(t.center,"height")),_=new r.Rect(0,0,l.rect.width,l.rect.height);if(h.width=s.calculateNodeWidth(t,d,g,m,p,f,_,i,a),h.height=s.calculateNodeHeight(t,d,g,m,p,f,_,i,a),e){e.attr("height",h.height).attr("width",h.width);let t=o.convertToSVGCoords(s._svg,e);h.height=t.height,h.width=t.width,e.attr("height",0).attr("width",0).transition().duration(s.getAnimateDuration()).attr("x",0).attr("y",0).attr("height",h.height).attr("width",h.width)}if(l.rect=h,n){o.getStyle(n);let t=(h.width-_.width)/2,e=a;n.transition().duration(s.getAnimateDuration()).attr("transform","translate("+t+","+e+")")}let y=h.width/2,v=y-d.width/2,x=s._padding+_.height+d.height/2;s.transformHorizontalNodes(v,x,t.top,i);let w=p.width+(h.width-f.width-p.width)/2,b=d.height+_.height+(h.height-g.height-d.height-_.height)/2;if(v=s._padding+p.width/2,s.transformVerticalNodes(v,b-p.height/2,t.left,i),v=h.width-(f.width+s._padding)/2,s.transformVerticalNodes(v,b-f.height/2,t.right,i),v=y-g.width/2,x=h.height-g.height/2-s._padding,s.transformHorizontalNodes(v,x,t.bottom,i),t.center&&t.center.length>0){let e=w-m.width/2;p.width&&(e=Math.max(e,s._padding+p.width+Math.max(i,Math.max(this.getStylePropertyMax(t.left,"margin-right"),parseInt(o.getStyle(s._nodes[t.center[0].key].d3selection)["margin-left"]))))),f.width&&(e=Math.min(e,h.width-s._padding-f.width-m.width-Math.max(i,Math.max(this.getStylePropertyMax(t.right,"margin-left"),parseInt(o.getStyle(s._nodes[t.center[t.center.length-1].key].d3selection)["margin-left"])))));let n=b;d.height&&(n=Math.max(n,s._padding+d.height+Math.max(i,Math.max(this.getStylePropertyMax(t.top,"margin-bottom"),this.getStylePropertyMax(t.center,"margin-top")))+m.height/2)),g.height&&(n=Math.min(n,h.height-s._padding-g.height-m.height/2-Math.max(i,Math.max(this.getStylePropertyMax(t.center,"margin-bottom"),this.getStylePropertyMax(t.bottom,"margin-top"))))),s.transformHorizontalNodes(e,n,t.center,i)}}configureItemHover(t,e){let n=this;e.def.disableHover?t.on("mouseenter",(function(){t.classed("hover",!0)})).on("mouseleave",(function(){t.classed("hover",!1)})):t.on("mouseenter",n.nodeHoverStart).on("mouseleave",n.hoverEnd),e.def.hideTooltip||n._dataTooltip.setTarget(t);let r=this._element;o.addClickHelper(t,r.onClick,r.onDoubleClick,r.contextMenuItems,n._dataTooltip,r),t.node().__data__=e.def}renderNodes(t,e,n,a){let s=this;e.depth=a;let h={def:e,ports:{}};if(s._nodes[e.key]=h,e.parent=t,s._decimator&&!s._decimator.isVisible(e))return void delete h.d3selection;let u=function(){if(e.type&&e.type.length>0)for(let t=0;t<e.type.length;++t)if(s._colorMgr.hasColor(e.type[t]))return s._colorMgr.getColor(e.type[t]);return e.key&&s._colorMgr.hasColor(e.key)?s._colorMgr.getColor(e.key):"white"},c=i.getSelectionName(e.key)+" node ";if(e.type&&e.type.length>0)for(let t=0;t<e.type.length;++t)c+=" "+i.getSelectionName(e.type[t]);let d,g,p=n.append("g").classed(c,!0);h.d3selection=p,e.hideBorder||(d=p.append("rect").classed(c,!0).classed("border",!0).attr("fill",u).attr("stroke","black").attr("stroke-opacity",.2).attr("rx",6).attr("ry",6),s.configureItemHover(d,h));for(let t=0;t<l.CHILDREN.length;++t){let n=l.CHILDREN[t];if(e.hasOwnProperty(n))for(let t=0;t<e[n].length;++t)s.renderNodes(e,e[n][t],p,a+1)}let f,m,_,y,v=new r.Rect(0,0,0,0);if(!e.hideImageLabel&&(e.label||e.image)){if(g=p.append("g").classed(c,!0),e.image){f=g.append("image").attr("xlink:href",e.image).classed(c,!0).attr("x",s._renderOrigin.x).attr("y",s._renderOrigin.y);let t=parseInt(o.getStyle(f).height),n=parseInt(o.getStyle(f).width);f.attr("height",t||(e.imageHeight?e.imageHeight:40)),f.attr("width",n||(e.imageWidth?e.imageWidth:40)),s.configureItemHover(f,h),m=o.convertToSVGCoords(s._svg,f),v.width=Math.max(v.width,m.width),v.height+=m.height}e.label&&(_=g.append("text").classed(c,!0).attr("x",s._renderOrigin.x).attr("y",s._renderOrigin.y).attr("text-anchor","middle").attr("alignment-baseline","middle").text(e.label),s.configureItemHover(_,h),y=o.convertToSVGCoords(s._svg,_),v.width=Math.max(v.width,y.width),v.height+=y.height)}0!==s._renderOrigin.x||0!==s._renderOrigin.y?(d&&d.attr("x",s._renderOrigin.x).attr("y",s._renderOrigin.y),m&&f.transition().duration(s.getAnimateDuration()).attr("x",v.width/2-m.width/2).attr("y",0),y&&_.transition().duration(s.getAnimateDuration()).attr("x",v.width/2).attr("y",v.height-y.height/2)):(m&&f.attr("x",v.width/2-m.width/2).attr("y",0),y&&_.attr("x",v.width/2).attr("y",v.height-y.height/2)),h.rect=v,s.transformNode(e,d,g,s._margin,s._padding)}createLinks(t){let e=[],n=this;for(let i=0;i<t.length;++i){let a=n._nodes[t[i].from],s=n._nodes[t[i].to];if(n._decimator){for(;a&&!n._decimator.isVisible(a.def);)a=n._nodes[a.def.parent.key];for(;s&&!n._decimator.isVisible(s.def);)s=n._nodes[s.def.parent.key]}if(void 0===a||void 0===s)continue;let l=a.def.depth>s.def.depth?a:s,h=a.def.depth>s.def.depth?s:a;for(;h.def.depth!=l.def.depth;)l=n._nodes[l.def.parent.key];if(h===l)continue;let u={def:t[i],source:{node:a,endPoint:void 0,alignment:void 0},target:{node:s,endPoint:void 0,alignment:void 0}};e.push(u);let c=o.convertToSVGCoords(n._svg,a.d3selection),d=o.convertToSVGCoords(n._svg,s.d3selection);c.bottom<d.y?(a.ports.bottom||(a.ports.bottom=[]),s.ports.top||(s.ports.top=[]),a.ports.bottom.push(u),s.ports.top.push(u),u.source.alignment=r.Alignment.Bottom,u.target.alignment=r.Alignment.Top):c.y>d.bottom?(a.ports.top||(a.ports.top=[]),s.ports.bottom||(s.ports.bottom=[]),a.ports.top.push(u),s.ports.bottom.push(u),u.source.alignment=r.Alignment.Top,u.target.alignment=r.Alignment.Bottom):c.right<d.x?(a.ports.right||(a.ports.right=[]),s.ports.left||(s.ports.left=[]),a.ports.right.push(u),s.ports.left.push(u),u.source.alignment=r.Alignment.Right,u.target.alignment=r.Alignment.Left):(a.ports.left||(a.ports.left=[]),s.ports.right||(s.ports.right=[]),a.ports.left.push(u),s.ports.right.push(u),u.source.alignment=r.Alignment.Left,u.target.alignment=r.Alignment.Right)}return e}mergeNodePorts(t,e){let n={},r=0;for(let i=0;i<t.length;++i){let o=t[i],a=o.def;o.source.node===e?a.fromConnectionPoint?(void 0===n[a.fromConnectionPoint]&&(n[a.fromConnectionPoint]=++r),o.source.endPoint=n[a.fromConnectionPoint]):o.source.endPoint=++r:a.toConnectionPoint?(void 0===n[a.toConnectionPoint]&&(n[a.toConnectionPoint]=++r),o.target.endPoint=n[a.toConnectionPoint]):o.target.endPoint=++r}t.length=r}orderNodePorts(){for(let t in this._nodes){let e=this._nodes[t],n=function(t,n){let r=t.source.node===e?t.target.node:t.source.node,i=n.source.node===e?n.target.node:n.source.node;return r.d3selection.node().getBoundingClientRect().top-i.d3selection.node().getBoundingClientRect().top},r=function(t,n){let r=t.source.node===e?t.target.node:t.source.node,i=n.source.node===e?n.target.node:n.source.node;return r.d3selection.node().getBoundingClientRect().left-i.d3selection.node().getBoundingClientRect().left};e.ports.top&&(e.ports.top.sort(r),this.mergeNodePorts(e.ports.top,e)),e.ports.bottom&&(e.ports.bottom.sort(r),this.mergeNodePorts(e.ports.bottom,e)),e.ports.left&&(e.ports.left.sort(n),this.mergeNodePorts(e.ports.left,e)),e.ports.right&&(e.ports.right.sort(n),e.ports.right.sort(n),this.mergeNodePorts(e.ports.right,e))}}renderLinks(t,e){let n=this.createLinks(t);this.orderNodePorts(),this.renderLinkHelper(e,n)}sizeViewToFit(t){let e,n=this._nodes[t.key].rect;return this._options.fitToWindow?(e=this._svg.transition("resizeView").duration(this.getAnimateDuration()).attr("viewBox","0 0 "+n.width+" "+n.height).attr("preserveAspectRatio","xMidYMid meet"),this._options.width?e.attr("width",this._options.width).attr("height",void 0):this._options.height?e.attr("width",void 0).attr("height",this._options.height):e.attr("width","100%").attr("height",void 0)):e=this._svg.transition("resizeView").duration(this.getAnimateDuration()).attr("width",n.width).attr("height",n.height),e}renderHelper(t,e=!1){let n=this;n._nodes={};let r=n._svg.insert("g","g").classed("graph",!0),i=n.getAnimateDuration();e&&(n._options.animateDuration=0,r.attr("opacity",0)),n._decimator=n._element.decimator,n.renderNodes(void 0,t,r,0),n.initializeLinkLayer(r);let o=n._element.links;return r.transition("nodeWait").duration(n.getAnimateDuration()).on("end",(function(){n.renderLinks(o,r)})),e?n._options.animateDuration=i:n.sizeViewToFit(t),r}render(t){let e=this;e._element;e._margin=30,e._padding=10,e.loadOptions(t);let n=e._element.nodes,r=e._svg.select(".graph"),i=e.getAnimateDuration();if(0!==i){let t=e._nodes[n.key];e._renderOrigin={x:0,y:0};let a,s=e.renderHelper(n,!0),l=r.select("rect").node();if(l&&(a=e._nodes[l.__data__.key]),t){let a=e._nodes[n.key],l=o.convertToSVGCoords(e._svg,t.d3selection),h=r.transition("translateOldNode").duration(i).attr("transform","translate(-"+l.x+",-"+l.y+")"),u=e.sizeViewToFit(n);t.d3selection.selectAll("*").size()!==a.d3selection.selectAll("*").size()?(s.remove(),u.transition().duration(i/2).attr("width",0).attr("height",0).on("end",(function(){r.remove(),e.renderHelper(n)}))):h.on("end",(function(){r.remove(),s.attr("opacity",1)}))}else a&&a.d3selection?setTimeout((function(){let t=o.convertToSVGCoords(e._svg,a.d3selection),l=t.x,h=t.y;e._renderOrigin={x:(t.x+t.right)/2,y:(t.y+t.bottom)/2};let u=a.d3selection.selectAll("*").size()!==r.select(".node").selectAll("*").size();s.remove();r.transition("translateOldNode").duration(i).attr("width",0).attr("height",0).attr("transform","translate("+l+","+h+")").on("end",(function(){u&&r.remove(),e.renderHelper(n).transition().duration(e.getAnimateDuration()).on("end",(function(){u||r.remove()}))}));e.sizeViewToFit(n)}),0):(s.remove(),e._renderOrigin={x:0,y:0},e._svg.transition("hideView").duration(i).attr("width",0).attr("height",0).on("end",(function(){r.remove(),e.renderHelper(n)})))}else e._renderOrigin={x:0,y:0},r.remove(),e.renderHelper(n)}}e.D3HierarchyGraph=l,l.CHILDREN=["top","bottom","left","right","center"],s.D3Renderer.register(r.UIType.HierarchyGraph,l)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(0),o=n(26),a=n(4),s=n(3),l=n(2),h=n(10),u=n(41),c=n(20),d=n(14);class g{updatePosition(t){this.def.x+=t.dx,this.def.y+=t.dy,this._nodeContainer.attr("transform",`translate(${this.def.x}, ${this.def.y})`)}renderPort(t,e){return this._nodeContainer.append("circle").attr("class",this._portDiagram.getClasses(this.def)+" "+t.key).classed("port",!0).attr("cx",t.x).attr("cy",t.y).attr("r",f).attr("fill","white").attr("stroke-width",1).attr("stroke",this._portDiagram.getColor(this.def))}}class p{initializeNode(){this._nodeContainer=new h.Container}getNode(){return this._nodeContainer}updatePosition(t){this.def.x+=t.dx,this.def.y+=t.dy,this._nodeContainer.x=this.def.x,this._nodeContainer.y=this.def.y}renderPort(t,e){let n=e.manager.add(this.def.type[0],this.def.key,h.SCALE_MODES.LINEAR,1,(function(){let t=new h.Graphics;return t.beginFill(e.color),t.drawCircle(0,0,f),t.beginFill(16777215),t.drawCircle(0,0,f-1),t.endFill(),t}));return n.x=t.x-f,n.y=t.y-f,this._nodeContainer.addChild(n),n}}let f=3,m={x:-25,y:-25,height:50,width:50};class _{constructor(t){this.def=t}configureNode(){this.def.height=50,this.def.width=50}getPortAreaRect(){return m}}class y{constructor(t){this.def=t}getXYOffset(){return{x:.5*-this.def.width,y:.5*-this.def.height}}getTitle(){return this.def.type.length>0?this.def.type[0]:"None"}getTitleTextRect(){throw"Error please implement this function"}configureNode(){let t=this.def,e=t.ports.top?t.ports.top.length:0,n=t.ports.bottom?t.ports.bottom.length:0,r=t.ports.left?t.ports.left.length:0,o=t.ports.right?t.ports.right.length:0,a=this.getTitleTextRect(),s=a.height+6,l=s+6+50,h=a.width+6,u=.5*-h,c=.5*-l;this._portRect=new i.Rect(u,s+c,Math.max(15*Math.max(e,n),h),Math.max(15*Math.max(r,o),l)),this.def.height=s+this._portRect.height,this.def.width=this._portRect.width}getPortAreaRect(){return this._portRect}}class v extends _{constructor(t,e){super(t),this._portDiagram=e,this.updatePosition=g.prototype.updatePosition.bind(this),this.renderPort=g.prototype.renderPort.bind(this)}renderNode(t){return this._nodeContainer=t.group.append("g"),this._nodeContainer.append("circle").attr("class",this._portDiagram.getClasses(this.def)).classed("node",!0).attr("r",25).attr("cx",0).attr("cy",0).attr("fill",this._portDiagram.getColor(this.def)),void 0!==this.def.x&&this.updatePosition({dx:0,dy:0}),this._nodeContainer}}class x extends _{constructor(t){super(t),this.initializeNode=p.prototype.initializeNode.bind(this),this.getNode=p.prototype.getNode.bind(this),this.updatePosition=p.prototype.updatePosition.bind(this),this.renderPort=p.prototype.renderPort.bind(this)}renderNode(t){this.initializeNode();let e=t.manager.add(this.def.type[0],this.def.key,h.SCALE_MODES.LINEAR,4,(function(){let e=new h.Graphics;return e.beginFill(16777215),e.drawCircle(-25,-25,25),e.beginFill(t.color),e.drawCircle(-25,-25,24),e.endFill(),e}));return e.x=-25,e.y=-25,this._nodeContainer.addChild(e),void 0!==this.def.x&&this.updatePosition({dx:0,dy:0}),e}}class w extends y{constructor(t,e,n){super(t),this._portDiagram=e,this._svg=n,this.updatePosition=g.prototype.updatePosition.bind(this),this.renderPort=g.prototype.renderPort.bind(this)}getTitleTextRect(){return s.getTextRect(this._svg,this.getTitle())}renderNode(t){this._nodeContainer=t.group.append("g");let e=this._nodeContainer.append("rect"),n=this._nodeContainer.append("rect"),r=this._nodeContainer.append("text"),i=this.getXYOffset(),o=i.x,a=i.y,s=this.getTitle();return r.text(s).attr("fill","white").attr("stroke","white").attr("alignment-baseline","hanging").attr("x",o+3).attr("y",a+3),e.attr("class",this._portDiagram.getClasses(this.def)).classed("node",!0).classed("border",!0).attr("fill","#FFFFFF").attr("stroke","#000000").attr("stroke-width",1).attr("x",o).attr("y",a).attr("width",this.def.width).attr("height",this.def.height).attr("rx",3).attr("ry",3),n.attr("class",this._portDiagram.getClasses(this.def)).classed("node",!0).classed("title-box",!0).attr("fill",this._portDiagram.getColor(this.def)).attr("x",o).attr("y",a).attr("width",this.def.width).attr("height",20).attr("rx",3).attr("ry",3),void 0!==this.def.x&&this.updatePosition({dx:0,dy:0}),this._nodeContainer}}class b extends y{constructor(t,e){super(t),this._pixiHelper=e,this.initializeNode=p.prototype.initializeNode.bind(this),this.getNode=p.prototype.getNode.bind(this),this.updatePosition=p.prototype.updatePosition.bind(this),this.renderPort=p.prototype.renderPort.bind(this)}getTitleTextRect(){let t=this.getTitle();return this._pixiHelper.renderText(t,l.select(this._pixiHelper.getRenderer().view.parentNode),16777215)}renderNode(t){this.initializeNode();let e=`${this.def.type[0]}H${this.def.height}W${this.def.width}`;e+=this.def.ports.top?`T${this.def.ports.top.length}`:"",e+=this.def.ports.left?`L${this.def.ports.left.length}`:"",e+=this.def.ports.right?`R${this.def.ports.right.length}`:"",e+=this.def.ports.bottom?`B${this.def.ports.bottom.length}`:"";let n=t.manager.add(e,this.def.key,h.SCALE_MODES.LINEAR,1,()=>{let e=this.getTitle();this._titleText=this._pixiHelper.renderText(e,l.select(this._pixiHelper.getRenderer().view.parentNode),16777215),this._titleText.x=3,this._titleText.y=3;let n=new h.Graphics;return n.beginFill(16777215,1),n.lineStyle(1,0,.7),n.drawRoundedRect(0,0,this._portRect.width,this.def.height,3),n.beginFill(t.color,1),n.drawRoundedRect(0,0,this._portRect.width,this._titleText.height+6,3),n.addChild(this._titleText),n}),r=this.getXYOffset();return n.x=r.x,n.y=r.y,this._nodeContainer.addChild(n),void 0!==this.def.x&&this.updatePosition({dx:0,dy:0}),n}}class M extends a.UIElementRenderer{constructor(t,e,n){super(),this._nodePortInfo={},this._options={},this.invalidate=this.render,this._element=t,this._rendererManager=e,this._parent=n,this._nodes={},this._requiresLayout=!1,this._renderedNodes=[];let r=this;this.getLinkStartXY=function(t){let e=r._nodes[t.def.from],n=t.def,i=r._nodePortInfo[e.key][n.fromPort];return{x:e.x+i.x,y:e.y+i.y}},this.getLinkEndXY=function(t){let e=r._nodes[t.def.to],n=t.def,i=r._nodePortInfo[e.key][n.toPort];return{x:e.x+i.x,y:e.y+i.y}}}hover(t){this._renderer.hover(t)}cursorChange(t){}brush(t){this._renderer.brush(t)}addNodePorts(t,e,n){let r=this;if(t){let o=e.def.key;r._nodePortInfo[o]||(r._nodePortInfo[o]={});let a=e.getPortAreaRect(),s=a.height/t.length,l=.5*s,h=a.width/t.length,u=.5*h,c=r._nodePortInfo[o];switch(n){case i.Alignment.Top:t.forEach((function(t,e){let r=a.x+u+h*e;c[t.key]={key:t.key,index:e,alignment:n,x:r,y:0}}));break;case i.Alignment.Bottom:t.forEach((function(t,r){let i=a.x+u+h*r;c[t.key]={key:t.key,index:r,alignment:n,x:i,y:e.def.height}}));break;case i.Alignment.Left:t.forEach((function(t,e){let r=l+s*e+a.y;c[t.key]={key:t.key,index:e,alignment:n,x:a.x,y:r}}));break;case i.Alignment.Right:t.forEach((function(t,r){let i=l+s*r+a.y;c[t.key]={key:t.key,index:r,alignment:n,x:a.x+e.def.width,y:i}}))}}}addPorts(t){this.addNodePorts(t.def.ports.left,t,i.Alignment.Left),this.addNodePorts(t.def.ports.right,t,i.Alignment.Right),this.addNodePorts(t.def.ports.top,t,i.Alignment.Top),this.addNodePorts(t.def.ports.bottom,t,i.Alignment.Bottom)}getColor(t){let e,n=this._rendererManager.getColorManager();return e=n.hasColor(t.key)?n.getColor(t.key):t.type?n.getColor(t.type[0]):n.getColor(t.key),e}getClasses(t){let e=t.key;return t.type.forEach((function(t){e+=" "+t})),e}addNode(t){t.configureNode(),this._nodes[t.def.key]=t.def}createRenderedLinks(){let t=this._element.links,e=[],n=this;return t.forEach((function(t){let r=n._nodes[t.from],i=n._nodes[t.to];if(!r||!i)return;let o=n._nodePortInfo[r.key][t.fromPort],a=n._nodePortInfo[i.key][t.toPort],s={def:t,source:{node:r,alignment:o.alignment},target:{node:i,alignment:a.alignment}};e.push(s)})),e}layout(t,e){let n=this._element;if(n.nodes&&n.nodes.length>0&&void 0===n.nodes[0].x){var r=new u.graphlib.Graph;r.setGraph({rankdir:"LR"}),r.setDefaultEdgeLabel((function(){return{}})),t.forEach(t=>{t.def.label=t.def.key,r.setNode(t.def.key,t.def)}),e.forEach(t=>{r.setEdge(t.def.from,t.def.to)}),u.layout(r),t.forEach(t=>{t.updatePosition({dx:0,dy:0})})}}render(t){r.merge(this._options,t),this._renderer||(this._options.forceSvgRenderer?this._renderer=new k(this._element,this._rendererManager,this._parent,this):this._renderer=new C(this._element,this._rendererManager,this._parent,this),this._renderer.setColorManager(this._colorMgr)),this._renderer.render(t)}}e.D3PortDiagram=M;class k extends c.D3ConnectedGraphSVG{constructor(t,e,n,r){super(t,e,n),c.DiagramBase.prototype.bind.call(this,this._renderer,this._element),this._portDiagram=r,this.getLinkStartXY=r.getLinkStartXY,this.getLinkEndXY=r.getLinkEndXY}render(t){let e=this.initializeGraphArea(t);this.initializeLinkLayer(e);let n=this.renderNodes(e),r=this._portDiagram.createRenderedLinks();this._portDiagram.layout(n,r),this.renderLinkHelper(e,r),this.configureView()}renderNodes(t){let e=this,n=e._element;e._portDiagram._nodePortInfo={};let r=[],i=t.append("g").attr("class","nodes");return n.nodes.forEach(a=>{if(n.decimator&&!n.decimator(a))return;let h;h=n.nodeRenderType===o.NodeType.NodeRectangle||a.renderType===o.NodeType.NodeRectangle?new w(a,e._portDiagram,e._svg):new v(a,e._portDiagram),e._portDiagram.addNode(h),e._portDiagram.addPorts(h),r.push(h);let u=h.renderNode({group:i}).on("mouseenter",e.nodeHoverStart).on("mouseleave",e.hoverEnd).call(l.drag().on("drag",(function(n){e._dataTooltip.hideTooltip(),h.updatePosition(l.event);let r=[];t.selectAll(".link."+n.key).each((function(t){r.push(t)})),e.renderLinkHelper(t,r,!0)})));if(u.node().__data__=h.def,s.addClickHelper(u,n.onClick,n.onDoubleClick,n.contextMenuItems,e._dataTooltip,n,h),e._dataTooltip.setTarget(u),!e._element.disablePortRendering){let t=this._portDiagram._nodePortInfo[h.def.key];for(let e in t){let r=t[e],i=h.renderPort(r);i.node().__data__=r,s.addClickHelper(i,n.onClick,n.onDoubleClick,n.contextMenuItems,this._dataTooltip,n,r),this._dataTooltip.setTarget(i)}}}),r}}e.D3PortDiagramSVG=k,a.D3Renderer.register(i.UIType.PortDiagram,M);class C extends c.D3ConnectedGraphPixi{constructor(t,e,n,r){super(t,e,n),this._portDiagram=r,this.getLinkStartXY=r.getLinkStartXY,this.getLinkEndXY=r.getLinkEndXY}renderNodes(t){let e=this,n=e._element;e._nodeGraphics=new d.GraphicsManager(e._pixi),e._element.disablePortRendering||(e._portGraphics=new d.GraphicsManager(e._pixi));let r=[];return n.nodes.forEach((function(i){let a;if(a=n.nodeRenderType===o.NodeType.NodeRectangle||i.renderType===o.NodeType.NodeRectangle?new b(i,e._pixiHelper):new x(i),e._portDiagram.addNode(a),e._portDiagram.addPorts(a),r.push(a),n.decimator&&!n.decimator(i))return;let s=parseInt(e._portDiagram.getColor(i).substring(1),16),l=a.renderNode({color:s,manager:e._nodeGraphics});if(l.__data__=i,e._pixiHelper.addSelection(i.key,l),e._pixiHelper.addInteractionHelper(l,n.onClick,n.onDoubleClick,n.contextMenuItems,e.nodeHoverStart,e.hoverEnd,e._dataTooltip,n,i),!e._element.disablePortRendering){let t=e._portDiagram._nodePortInfo[i.key];for(let r in t){let o=t[r],l=a.renderPort(o,{color:s,manager:e._portGraphics});e._pixiHelper.addSelection(i.key,l),e._pixiHelper.addSelection(i.key+o.key,l),e._pixiHelper.addInteractionHelper(l,n.onClick,n.onDoubleClick,n.contextMenuItems,e.nodeHoverStart,e.hoverEnd,e._dataTooltip,n,{def:o})}}let h,u=a.getNode();function c(e){this.data=e.data,this.dragging=!0,t.itemDragging=!0,h=this.data.getLocalPosition(u.parent),e.stopPropagation()}function d(n){if(this.dragging){e._dataTooltip.hideTooltip();let r=this.data.getLocalPosition(u.parent);r.dx=r.x-h.x,r.dy=r.y-h.y,a.updatePosition(r),e.renderLinkHelper(t,e._renderedLinks),e._pixiHelper.render(),n.stopPropagation(),h=r}}function g(){this.dragging=!1,t.itemDragging=!1,this.data=null}l.on("mousedown",c).on("touchstart",c).on("mouseup",g).on("mouseupoutside",g).on("touchend",g).on("touchendoutside",g).on("mousemove",d).on("touchmove",d),t.addChild(u)})),r}render(t){r.merge(this._options,t);let e=this;e._element;if(!(void 0===this._pixiHelper)&&(t.height||t.width))return this._pixi.resize(e._options.width,e._options.height),void this._pixiHelper.render();e._portDiagram._nodePortInfo={};let n=e.initializeGraphArea(t),i=e.renderNodes(n);this._renderedLinks=e._portDiagram.createRenderedLinks(),e._portDiagram.layout(i,this._renderedLinks),e.renderLinkHelper(n,this._renderedLinks),e.configureView(),e._pixiHelper.render(n)}}e.D3PortDiagramPixi=C,a.D3Renderer.register(i.UIType.PortDiagram,M)},function(t,e){t.exports=i}])}));